\section{Nash equilibria and variational inequalities}
Calculating Nash equilibria is generally a hard problem. A fruitful approach to calculating Nash equilibria is via. the theory of complementarity problems and variational inequalities \citep{karamardian1969nonlinear,nabetani2011parametrized}. We unite the approach of variational inequalities and mean-field games which allows us to characterize a situation that guarantees uniqueness and existence of Nash equilibria in population games, and the existence of fixed-points of these games.

%We develop the theory for monomorphic games, and finally introduce a method to analyze a mean-field game as a monomorphic game.

As in \Cref{sec:general_setting}, our habitat is a measure space $(X,\mu)$ with $M$ different types inhabiting it with payoff-functions $U_i$. The simplest example our framework needs to handle is that of a single type with population $N$ inhabiting $X$ with foraging distribution $\sigma$. The encounter rate of an individual following the strategy $\sigma$ with the entire population also following the strategy $\sigma$ has the density $N\sigma^2$. The expected encounter rate then becomes
\begin{equation}
  \int_X \sigma^2 d\mu
\end{equation}
and this quantity must be finite, hence the appropriate setting for our work is the space $L^2(X)$. This motivates our space of feasible strategies.
\begin{definition}
  Define $H$ as the real Hilbert space $L^2(X)$, where $X$ is a measure space. Define $H_+ \subset H$ as the a.e. positive functions in $H$.
\end{definition}
Finding Nash equilibria is one of the oldest applications of complementarity theory \citep{karamardian1969nonlinear}. We define a complementarity problem:
\begin{definition}
  Let $H$ be a real Hilbert space, and $K \subset H$ be a closed convex cone. Define $K^* = \{ x \in H : \ip{x}{y} = 0, \quad \forall y\in K\} $. Assume $T:K \to H$. The complementarity problem $CP(T,K)$ is the problem of finding an element $x^*$ such that
  \begin{equation}
    \begin{split}
    \ip{x^*}{Tx^*} = 0 \\
    Tx \in K^*, \quad  x\in K
  \end{split}
  \end{equation}
\end{definition}
As a general rule showing existence and uniqueness for complementarity problems is hard, which is where their relationship to variational inequalities comes in handy.
\begin{definition}
  Let $H$ be a real Hilbert space and $K\subset H$ be a non-empty subset of $H$. Let $T: K \to H$. The variational inequality $VI(T,K)$ is the following system
  \begin{equation}
    x \in K, \ip{y-x}{Tx} \geq 0, \quad \forall y \in K
  \end{equation}
  and a solution is an $x$ satisfying the inequality.
\end{definition}
%If $K$ is a convex cone, the problems $VI(T,K)$ and $CP(T,K)$ have the same solutions, which can be seen by setting $y=2x$ and $y=0$ respectively.

To motivate the approach based on complementarity and variational inequalities, assume that we have a mean-field game with $M$ players, payoff functions $U_i$, and strategies $\sigma_i, \overbar{\sigma}_i$. At the Nash equilibrium, each payoff function $U_i$ must satisfy the Karush-Kuhn-Tucker (KKT) conditions with respect to $\sigma_i$, along with $\overbar{\sigma}=\sigma$ as in \Cref{prop:doubleup}.
\begin{align}
  \nabla_{\sigma_i}U_i((\sigma_j)_{j=1}^N) \mid_{\sigma_i = \overbar{\sigma}_i}  + \mu_i - \lambda \cdot 1 = 0
  \ip{\sigma_i}{\mu_i} = 0
  \mu_i \geq 0
  \sigma_i \geq 0
  \int_X \sigma_i - 1 = 0
\end{align}
The Nash equilibrium of the game specified by the family $(U_i)$ corresponds to finding a system $\sigma_i^*$ satisfying the KKT conditions simultaneously for every pair $U_i$, \citep{deimling2010nonlinear}. Thus the condition for a Nash equilibrium is:
\begin{equation}
  \begin{split}
  \begin{pmatrix}
    \nabla_{\sigma_1} U_1 \mid{\sigma_1 = \overbar{\sigma}_1} \\
    \vdots \\
    \nabla_{\sigma_N} U_N \mid{\sigma_N = \overbar{\sigma}_N}
\end{pmatrix} + \begin{pmatrix}
    \mu_1 \\
    \vdots \\
    \mu_N
\end{pmatrix} + \begin{pmatrix}
    \lambda_1 \cdot 1_k \\
    \vdots \\
    \lambda_N \cdot 1_k
\end{pmatrix} = 0 \\
\ip{
\begin{pmatrix}
  \mu_1 \\
  \vdots \\
  \mu_N
\end{pmatrix}}{ \begin{pmatrix}
  \sigma_1 \\
  \vdots \\
  \sigma_N
\end{pmatrix}} = 0 \\
\mu_i \geq 0 \\
  \sigma_i \geq 0 \\
    \int \sigma_i dx = 1
    \label{eq:KKT_total}
  \end{split}
\end{equation}
To simplify \Cref{eq:KKT_total}, we define $dU = \begin{pmatrix} \nabla_{\sigma_1} U_1 \\
    \vdots \\
    \nabla_{\sigma_N} U_N \end{pmatrix}$, $S=(\sigma_i)_{i=1}^M$, and $\lambda = (\lambda_i)_{i=1}^M$. Then the problem can be restated as
\begin{equation}
  \label{eq:complementarity_form}
  \ip{dU(S)+\lambda}{S} = 0 \\
  \ip{S_i-1}{1}\lambda = 0
  -dU(S)-\lambda \geq 0 \\
  \ip{S_i-1}{1} \in \{0 \}
  S\geq 0
  \lambda \in \R
\end{equation}
which is a complementarity problem with $K = (H_+ \osum \R)^n$, $K^* = (H_+ \osum \{0\})^n$ and
\begin{equation}
  T(S,\lambda)=\begin{pmatrix} dU(S) + \lambda \\ (\ip{\sigma_i}{1} - 1)_{i=1}^M \end{pmatrix}
\end{equation}
If we do not include the criterion $\int \sigma_i dx = 1$ explicitly, but instead consider the convex set $K=\{f \in H: \int f dx = 1\}$, the problem instead becomes finding a vector $S = (\sigma_i)_{i=1}^M$ that minimizes
\begin{equation}
  \ip{dU(S)}{S-T} \geq 0 \forall T\in K^n
\end{equation}
i.e. solves a variational inequality. Searching for a solution to a variational inequality is more tractable for theoretical considerations, while the complementarity formulation is preferable for solving the problem numerically.

In case the payoff-functions $U_i $ are sufficiently nice, the machinery of variational inequalities can be applied to show existence and uniqueness of the Nash equilibrium. Asking for convexity is too strong, but it turns out the weaker notion of strict pseudoconvexity is sufficient. See \Cref{sec:appendix} for further details.
\begin{remark}
  From here onwards, by $K \subset H$ denotes the closed convex set $\{\phi \in H_+ : \ip{\phi}{1} = 1 \}$.
\end{remark}

We can gather the results on pseudoconvex functions and their application to game theory in the following theorem:
\begin{theorem} \label{thm:nash_unique}
  Consider a game with $N$ players with strictly pseudoconvex payoff functions $U_i$ and strategies $\sigma_i$ in $H$. The game has a unique Nash equilibrium if
  \begin{equation}
    dU=
    \begin{pmatrix}
      \nabla_{\sigma_1} U_1\mid{\sigma_1 = \overbar{\sigma}_1}\\
      \vdots \\
      \nabla_{\sigma_N} U_N \mid{\sigma_N = \overbar{\sigma}_N}
    \end{pmatrix}
  \end{equation}
  satisfies the criterion of \Cref{thm:existence} or $H$ is finite dimensional.
\end{theorem}
\begin{proof}
   If each $\nabla_{\sigma_i} U_i$ is strictly pseudomonotone, then so is their direct sum $dU$ by bilinearity of the inner product. By \Cref{thm:uniqueness} this solution is unique since $dU$ is strictly pseudomonotone. So if the solution exists, it is unique. By assumption \Cref{thm:existence} gives existence of a solution of $VI(dU,K)$ in case $H$ is infinite dimensional. If $H$ is finite-dimensional then $K$ is compact and there exists a solution \Cref{rem:weak_compact}.
\end{proof}
As a consequence of \Cref{thm:nash_unique}, we can introduce an equilibrium between the Nash equilibria of a mean-field game and a game with monomorphic populations. If a mean-field game has a family of functions $U_i^{mon}$ satisfying $\nabla_{\sigma_i} U_i\mid{\sigma_i = \overbar{\sigma}_i} = \nabla_{\sigma_i} U_i^{mon}$, then the monomorphic game defined $U_i^{mon}$ has the same Nash equilbria, and can be studied equivalently.
\begin{definition}
  \label{def:correspondence}
  Consider a mean-field game with populations $N_1,\dots,N_M$ with individual payoffs $U_i(\sigma_i, (\overbar{\sigma}_j)_{j=1}^M, (N_j)_{j=1}^M)$. Assume $\nabla_{\sigma_i}U_i\mid_{\sigma_i=\overbar{\sigma}_i}$ admits a primitive $U_i^{mon}$ such that $\nabla_{\sigma_i} U_i\mid{\sigma_i = \overbar{\sigma}_i} = \nabla_{\sigma_i} U_i^{mon}$.
   We define the monomorphic equivalent game as the monomorpic game specified by the payoff functions $U_i^{mon}$.
\end{definition}
If a monomorpic equivalent game exists, it becomes possible to study the monomorphic game instead and e.g. use strict pseudoconvexity to establish strict pseudomonotonicity.

With \Cref{thm:nash_unique}, we can show that there exist unique fixed points of population games with strictly pseudoconvex monomorpic equivalent payoff functions and bounded dynamics.
\begin{theorem}
  \label{thm:pop_game_exists_unique}
  A population game with $N$ populations and dynamics specified by $f_i$, with strictly pseudoconvex monomorphic equivalent functions payoff $U^{mon}_i$ and strategies $\sigma_i$ has a unique fixed point with a unique Nash equilibrium if $f_i/x_i$ are strictly pseudomonotone and satisfy \Cref{thm:existence}, and the set of fixed points of $f_i$ is uniformly bounded in $\sigma$.
\end{theorem}
\begin{proof}
  The game specified by $\sigma_i$ has a unique Nash equilibrium for each $x\in \R^N$, given by a complementarity problem over $K$ with operator specified by $dU = (\nabla_{\sigma_i} U_i)_{i=1}^N$. The solution specifies a continuous mapping $G: K^N \to \R^N$, \cite[Theorem 4.2]{barbagallo2009continuity}. Likewise, due to the assumptions on $f_i$ the complementarity problem $\ip{(f_i)_{i=1}^N(x)}{x}$ has a unique solution for every $\sigma$. Denote this solution function by $F$.

  Finding a fixed point of the dynamical system along with a Nash equilibrium then corresponds to finding a fixed point of $F\circ H: \R_+^N \to \R_+^N$. Since $F$ is assumed to be uniformly bounded, hence has compact range, $F\circ H$ has compact range. Therefore $F\circ H$ has a fixed point by Schauders fixed point theorem.

  For uniqueness, note that for each vector $\sigma$, the variational inequality
  \begin{equation}
    x \in \R_+^n, \ip{(f_i/x_i)_{i=1}^N(x)}{y-x}\geq 0 \quad y\in \R_+^n
  \end{equation}
  has a unique solution, by strict pseudomonotonicity of $f_i/x_i$. If we append the two operators $(f_i)_{i=1}^N$ and $\nabla_{\sigma_i} U_i$, we get a single strictly pseudomonotone variational inequality, where there exists a unique solution, since all terms are strictly pseudomonotone.
 Therefore the simultaneous problem
\begin{equation}
  \begin{split}
  S\in K^n, \ip{dU(S))}{S'-S} \geq 0, \quad S' \in K^n \\
  x \in \R_+^n, \ip{(f_i/x_i)_{i=1}^N(x)}{y-x}\geq 0 \quad y\in \R_+^n
\end{split}
\end{equation}
  has a unique solution, showing the existence and uniqueness of a fixed point for a population game.
\end{proof}
Remark that the assumption of uniformly bounded fixed-point space as a function of the strategies is biologically reasonable, since e.g. Type II growth functions are uniformly bounded and a metabolic loss is usually constant.

Having established the general theory for Nash equilibria, and demonstrated how to handle mean-field games as monomorphic games, we are ready to apply the theory to a Rosenzweig-MacArthur system with fast adaptive behavior.
\section{Revisiting the Rosenzweig-MacArthur model}
\label{sec:model_rm}
%Having established the general framework, we can proceed to defining the concrete model of interest.
We consider a predator-prey system modeled as a Rosenzweig-MacArthur system, where the predators are specialized so that their hunting success is maximal in the most productive zone of the habitat.
We assume that predators $(N_p)$ and consumers $(N_c)$ inhabit the interval $[0,1]$. The mean strategy of the predator and consumer populations is, respectively $\overbar{\sigma}_c$, and $\overbar{\sigma}_p$.
The population dynamics are a modified Rosenzweig-MacArthur system. The predator clearance rate is $\beta_p = \beta_{l} + \beta_0$ where $\beta_l$ varies locally and $\beta_0$ is the minimal clearance rate.
Consumption events are assumed local, so the expected encounter rate between predators and prey is $N_c N_p \ip{\beta_p \overbar{\sigma}_p}{\overbar{\sigma}_c}$. To model intraspecific predator competition, we have added a term $N_p c\ip{\beta \overbar{\sigma}_p}{\overbar{\sigma}_p}$ where $c$ is a competition parameter. The carrying capacity is $K\phi + K_0$, where $\phi$ is a distribution, and $K_0$ is the minimal carrying capacity. Denote the maximal predator consumption rate by $F_p$, then the dynamics are:
\begin{align}
  \dot{N_c} &= f_c = N_c \pa{\ip{\overbar{\sigma}_c}{1-N_c \frac{\sigma_c \overbar{\sigma}_c}{K\phi + K_0}} - \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_p}{F_p + \ip{\beta_p \overbar{\sigma}_p}{\overbar{\sigma}_c} N_c} } \\
  \dot{N_p} &= f_p = N_p \pa{\epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c} - c \ip{\overbar{\sigma}_p}{\beta_p \overbar{\sigma}_p}  - \mu_p}
  \label{eq:dynamics}
\end{align}
the functions $\beta_p$ and $\phi$ are defined as
\begin{align}
  \beta_p &= 5 \frac{\exp(-(3 x)^2) + \beta_0}{\int_0^1 \exp(-(3 x)^2) + \beta_0 dx} \\
  \phi &= \frac{\exp(-3 x) + K_0}{\int_0^1 \exp(-3 x) dx + K_0 }
\end{align}
The choice of functions reflect a heterogeneous productivity and a predator specialized in hunting in the most productive zones.
\subsection{Existence and uniqueness of the equilibrium}
As in \Cref{sec:general_setting} we model predator and consumer movement as instantaneous. Each predator and consumer seeks to maximize its growth at every instant. The growth of an individual depends on the mean-field strategies of both predators and consumers. Denoting the individual consumer and predator strategies by $\sigma_c$ and $\sigma_p$ respectively, the instantaneous growths $U_c,U_p$ for a consumer and predator are:
\begin{align}
  U_c(\sigma_c, N_c \overbar{\sigma}_c, N_p\overbar{\sigma}_p) &= \ip{\beta_c \sigma_c}{1-\frac{\sigma_c \overbar{\sigma}_c N_c}{K\phi + K_0}} - \frac{F_p \ip{\beta_p \sigma_c}{\overbar{\sigma}_p} N_p}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c} \\
  U_p(\sigma_p, N_p \overbar{\sigma}_c, \overbar{\sigma}_p) &= \epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c} - c \ip{\sigma_p}{\beta_p \overbar{\sigma}_p}  - \mu_p
\end{align}
Denote the optimum by $^*$. At the Nash equilibrium $\sigma_c^*=\overbar{\sigma}_c$ and $\sigma_p^* = \overbar{\sigma}_p$. We convert both mean-field payoffs into a monomorphic equivalent form \Cref{def:correspondence}
\begin{align}
  \label{eq:mon_eq_forms}
  U_c^{mon}(\sigma_c, \sigma_p, N_c, N_p) &= \ip{\beta_c \sigma_c}{1-\frac{3}{2}\frac{\sigma_c^2 N_c}{K\phi + K_0}} - N_p\log\pa{F_p + \ip{\beta_p \sigma_c}{\sigma_p} N_c} \\
  U_p^{mon}(\sigma_p, \sigma_c, N_c, N_p) &= \epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}{F_p + \ip{\beta_p \sigma_c}{\sigma_p} N_c} - \frac{1}{2}c \ip{\sigma_p}{\beta_p \sigma_p}N_p  - \mu_p
\end{align}
We need to verify that $-U_c^{mon}$ and $-U_p^{mon}$ are strictly pseudoconvex, as well as show existence. To this end, we state a characterization of strict pseudomonotonicity for differentiable functions.
\begin{lemma}
  \label{lem:strict_pm}
  Let $K$ be a convex subset of $H$. A function $f: K \to \R$ is strictly pseudomonotone if
  \begin{equation}
    \ip{f(x)}{u} = 0 \Rightarrow \ip{(\nabla_x f(x))h}{h} > 0
  \end{equation}
\end{lemma}
A proof can be found in \citep[Proposition 2.8, p.96]{hadjisavvas2006handbook}.
Another small lemma we need is a reduction for pseudomonotone functions.
\begin{lemma}
  \label{lem:pseudo_reduc}
  A function $g: K \to H$ is pseudomonotone if and only if $g+\lambda$ is pseudomonotone for any $\lambda \in \R$.
\end{lemma}
\begin{proof}
  Consider $\ip{g(x)+\lambda}{x-y}=\ip{g(x)}{x-y}+\lambda \int x d\mu + \lambda \int y d\mu$
  Using that $\int y d\mu = \int x d\mu = 1$, we arrive at  $\ip{g(x)}{x-y}$.
  Hence the pseudomonotonicity of $g$ and $g+\lambda$ are equivalent.
\end{proof}
This allows us to state our main result on the behaviorally modified Rosenzweig-MacArthur game.
\begin{proposition}
  \label{prop:exist_unique_nash}
  The game defined by $U_c$ and $U_p$ has a unique Nash equilibrium for every non-zero pair $N_c,N_p$.
\end{proposition}
\begin{proof}
  It suffices to show that the functions $-U_c^{mon}$ and $-U_p^{mon}$ are strictly pseudoconvex for uniqueness. For existence it remains to show that $\begin{pmatrix}-\nabla_{\sigma_c} U_c^{mon} \\ -\nabla_{\sigma_p} U_p^{mon}\end{pmatrix}$ satisfy the criteria of \Cref{thm:existence}.
  We start by showing the strict pseudoconvexity. The function $-U_p^{mon}$ is strictly convex, as it has strictly positive second derivative with respect $\sigma_p$. Consider $-U_c^{mon}$. To show strict pseudoconvexity, by \Cref{lem:pseudo_reduc} it suffices to show that $f = -\nabla_{\sigma_c} U_c^{mon} - 1$ is strictly pseudomonotone. For \Cref{lem:strict_pm} assume $\ip{f(x)}{u} = 0$, then
  \begin{equation}
    \ip{x}{u}\frac{N_c \beta_c }{K\phi + K_0} + \frac{\ip{\sigma_p}{h}}{F_p + \ip{\sigma_p}{x}} = 0
  \end{equation}
  Since every term is positive, $\ip{x}{u} = 0$ and $\ip{\sigma_p}{h} = 0$. If we consider
  \begin{equation}
    H(x,u)=\ip{(\nabla_x f)(x)u}{u} = \ip{u}{u}\frac{ C \beta_c }{K\phi + K_0} - \frac{\ip{\sigma_p}{u}\ip{\sigma_p}{h}}{F_p + \ip{\sigma_p}{x}}
  \end{equation}
  then $H(x,u)>0$ since $\ip{\sigma_p}{u}=0$, so $H$ is strictly pseudomonotone by \Cref{lem:strict_pm}. Hence $-U_c^{mon}$ is strictly pseudoconvex.

  To show that there exists a solution, start by noting that for all $w\in H^2$, $w\mapsto dU(w)$ is continuous, hence continuous on finite-dimensional subspaces, fulfilling the first part of \Cref{thm:existence}. For the second part,  consider
  \begin{equation}
    \label{eq:du}
    \begin{split}
    \ip{-dU(\sigma_c,\sigma_p)}{(1-\sigma_c, 1-\sigma_p)} =
    \ip{dU(\sigma_c,\sigma_p)}{(\sigma_c-1, \sigma_p-1)}
  \end{split}
  \end{equation}
  To avoid clutter, we neglect the calculations and relegate them to the appendix \Cref{appendix:calculations}. In the end, the inner product reduces to
  \begin{equation}
    \label{eq:fin_exist}
    \norm{\sigma_c}_2^2 + \norm{\sigma_p}_2^2 - \norm{\sigma_c}_1 - \norm{\sigma_p}_1 - G_1(\sigma_c,\sigma_p) - G_2(\sigma_c,\sigma_p)
  \end{equation}
  where $G_1,G_2$ are uniformly bounded. Recall that constraining the problem  to $K$ is equivalent to $\norm{\sigma_c}_1 = 1, \norm{\sigma_p} = 1$. Hence \Cref{eq:fin_exist} tends to infinity as $\norm{(\sigma_c,\sigma_p)}_2$ tends to infinity. Therefore \Cref{eq:du} is only negative on a bounded subset of $K$, showing existence of a solution to the variational inequality by \Cref{thm:existence}.

\end{proof}
Since we are also interested in the fixed-points of the population dynamics \Cref{eq:dynamics}, we are interested in showing that the fixed-point of the dynamics exists and is unique.
\begin{corollary}
  The population game \Cref{eq:dynamics} has a unique fixed point.
\end{corollary}
\begin{proof}
Here we can directly use the theory we have developed.  Both $f_1/N_c$ and $f_2/N_p$ are strictly monotone. Due to the metabolic terms and logistic terms set of fixed-points of these are uniformly bounded in $\sigma_c, \sigma_p$. By \Cref{prop:exist_unique_nash} the Nash equilibrium exists and is unique for every $N_c, N_p$. Therefore, by \Cref{thm:pop_game_exists_unique} there is a unique equilibrium for the population game.
\end{proof}

%By rephrasing the population into a varitaional inequality, we unlock the full arsenal of tools available for the solution of variational inequalities.

%We formulate the optimization problem as a feasibility problem via. the optimization framework casadi \citep{}. To solve the problems the solver IPOPT \citep{} is invoked, using the Haswell linear algebra routines \citep{}. This approach to solving variational inequalities is state-of-the-art, and the solver was both robust and fast.
%Keywords: Casadi, IPOPT, state-of-the-art, simple to expand and scalable.

%\begin{enumerate}
%  \item
%    Introduce the theory of Variational inequalities, simple game
%  \item
%    Introduce mean field game, modify predator-prey to the mean field case
%  \item
%    Introduce continuous setting
%\end{enumerate}

  \begin{comment} the mapping $S \mapsto \ip{dU(S)}{w}$


  is continuous in $S$ for all, implying lower semi-continuity, hence also lower-semicontinuity on line segments.
  For the technical criterion of \Cref{thm:existence} pick $u_0 = [1,1] \in H_+^2$ and consider $R=1+\epsilon$. We wish to show that there exists $\epsilon$ such that
  \begin{equation}
    \begin{split}
    \ip{-dU(\sigma_c,\sigma_p)}{(1-\sigma_c, 1-\sigma_p)} \geq 0 \\
    \ip{dU(\sigma_c,\sigma_p)}{(\sigma_c-1, \sigma_p-1)} \geq 0
  \end{split}
  \end{equation}
  for $\norm{(\sigma_c,\sigma_p)} = 1+\epsilon$.
  It is sufficient to show that there exists $\epsilon > 0$ such that each term in the inner product is positive. We start with the consumer term, using  $\ip{\sigma_c}{1}=1$
  \begin{equation}
    \begin{split}
    1-\ip{\sigma_c}{\sigma_c-1}\frac{ N_c \beta_c }{K\phi + K_0} - \frac{\ip{\sigma_p}{\sigma_c-1}}{F_p + \ip{\sigma_p}{\sigma_c}} \\
     =1-(1-\norm{\sigma_c}^2)\frac{ N_c \beta_c }{K\phi + K_0}+(1-\ip{\sigma_p}{\sigma_c})\frac{1}{F_p + \ip{\sigma_p}{\sigma_c}}
  \end{split}
  \end{equation}
  The terms $1-\norm{\sigma_c}^2$ and $1-\ip{\sigma_p}{\sigma_c}$ are uniformly bounded above by $\epsilon_1^2+2\epsilon_1$. If we define $\xi = \frac{C \beta_c }{K\phi + K_0}$ and $\eta = \frac{1}{F_p + \ip{\sigma_p}{\sigma_c}}$. We can then choose $\epsilon_1$ from the set satisfying:
  \begin{equation}
    (\epsilon_1^2+2\epsilon_1)(\xi+\eta) \leq 1
  \end{equation}
  For the predator term, we again use that $\ip{\sigma_p}{1} = 1$.
  \begin{equation}
    \begin{split}
        \ip{\sigma_p}{F_p^2\frac{N_c \beta_p}{(F_p + \ip{\beta_p\sigma_p}{\sigma_c})^2}-\sigma_p N_p}-\ip{1}{F_p^2\frac{N_c \beta_p}{(F_p + \ip{\beta_p\sigma_p}{\sigma_c})^2}-\sigma_p N_p} \\
        =\int_X (\sigma_p-1) F_p^2\frac{N_c \beta_p}{(F_p + \ip{\beta_p\sigma_p}{\sigma_c})^2 d\mu + N_p (\norm{\sigma_p}^2 + 1)
    \end{split}
  \end{equation}

  We can then pick the minimum of these two, showing the desired.
\end{comment}


\begin{comment}
Introducing the quality ($q$) of the habitat as a parameter, the functions $\beta_p$ and $\phi$ are given by
\begin{align}
  \beta_p &= 5 \frac{\exp(-(q x)^2) + \beta_0}{\int_0^1 \exp(-(q x)^2) + \beta_0 dx} \\
  \phi &= \frac{\exp(-q x) + K_0}{\int_0^1 \exp(-q x) dx + K_0 }
\end{align}
where the normalization is to keep a constant total encounter rate and carrying capacity of $K$ when varying $q$.
\end{comment}
