\section{Nash equilibria and variational inequalities}
Calculating Nash equilibria, \Cref{eq:tot_nash_eq} is generally a hard problem. A fruitful approach to calculating Nash equilibria is via. the theory of complementarity problems and variational inequalities \citep{karamardian1969nonlinear,nabetani2011parametrized}. We unite the approach of variational inequalities and mean-field games which allows us to characterize a situation that guarantees uniqueness and existence of Nash equilibria in population games, and the existence of fixed-points of these games.

%We develop the theory for monomorphic games, and finally introduce a method to analyze a mean-field game as a monomorphic game.

As in \Cref{sec:general_setting}, our habitat is a measure space $(X,\mu)$. We have $M$ different animal types coexisting with payoff-functions $U_i$. The simplest example our framework needs to handle is that of a single type with population $N$ inhabiting $X$ with following a distribution with density $\sigma$. The pointwise encounter rate of an individual following the strategy $\sigma$ with the entire population also following the strategy $\sigma$ is $N\sigma(x)^2$. The expected total encounter for an individual with its conspecifics is then
\begin{equation}
  N\int_X \sigma^2 d\mu
\end{equation}
and this quantity must be finite. This shows that the appropriate setting for our work is the space $L^2(X)$.
\begin{definition}
  Define the real Hilbert space $H=L^2(X)$, where $X$ is a measure space. Define $H_+ \subset H$ as the a.e. positive functions in $H$.
\end{definition}

\subsection{From Karush-Kuhn-Tucker to complementarity}
In order to find the Nash equilibrium of a population game, we need to solve \Cref{eq:tot_nash_eq}. We recall the setup of the $M$-player mean field game, now restricted to $H$. Assume we have $M$ different types of animals, with payoff functions $U_i$, and strategies $\sigma_i$, with corresponding mean-field strategies $\overbar{\sigma}_i$.
The Nash equilibrium of the game specified by the family $(U_i)$ corresponds to finding a system $\sigma_i^*$ satisfying the KKT conditions simultaneously for every $U_i$, \citep{deimling2010nonlinear}, with $\overbar{\sigma}=\sigma$ as in \Cref{eq:mfg_ne}. Denoting the identity operator on $H$ by $1_H$, the total criterion for a Nash equilibrium of a mean-field game \Cref{eq:tot_nash_eq} is:
\begin{equation}
  \label{eq:KKT_total}
  \begin{split}
  \nabla_{\sigma_i}U_i((\sigma_j)_{j=1}^M) \mid_{\sigma_i = \overbar{\sigma}_i}  + \mu_i - \lambda  \cdot 1_H = 0 \\
  \ip{\sigma_i}{\mu_i} = 0 \\
  \mu_i \in H_+ \\
  \sigma_i \in H_+ \\
  \int_X \sigma_i d\mu(x)- 1 = 0
\end{split}
\end{equation}
\begin{comment}
\begin{equation}
      \label{eq:KKT_total}
  \begin{split}
  \begin{pmatrix}
    \nabla_{\sigma_1} U_1 \mid{\sigma_1 = \overbar{\sigma}_1} \\
    \vdots \\
    \nabla_{\sigma_N} U_N \mid{\sigma_N = \overbar{\sigma}_N}
\end{pmatrix} + \begin{pmatrix}
    \mu_1 \\
    \vdots \\
    \mu_N
\end{pmatrix} + \begin{pmatrix}
    \lambda_1 \cdot 1_k \\
    \vdots \\
    \lambda_N \cdot 1_k
\end{pmatrix} = 0 \\
\ip{
\begin{pmatrix}
  \mu_1 \\
  \vdots \\
  \mu_N
\end{pmatrix}}{ \begin{pmatrix}
  \sigma_1 \\
  \vdots \\
  \sigma_N
\end{pmatrix}} = 0 \\
\mu_i \in H_+ \\
  \sigma_i \in H_+ \\
  \int \sigma_i d\mu = 1
    %\sigma \in P_{2,\mu}(X)
  \end{split}
\end{equation}
\end{comment}
Remark that the last two conditions are equivalent to $\sigma \in P_{\mu} \cap H$. This motivates the definition:
\begin{definition}
  Assume we have a measure space $(X,\mu)$. Consider the space of square-integrable functions $H=L^2(X,\mu)$ and space $P_{\mu}$ of probability densities over $X$. Define the space $P_{2,\mu}=H \cap P_{\mu}$ consisting of square-integrable probability densities.
\end{definition}
Solving the system in \Cref{eq:KKT_total} is highly non-trivial, but it turns out that reinterpreting the problem is helpful.
Finding Nash equilibria by interpreting the problem as a complementarity problem is one of the the original solutions to the hardness of finding Nash equilibria  \citep{karamardian1969nonlinear}. It turns out that the set of equations in \Cref{eq:KKT_total} is very close to being a complementarity problem, but first we need to introduce the notion.
\begin{definition}
  \label{def:comp_prob}
  Let $H$ be a real Hilbert space, and $K \subset H$ be a closed convex cone. Define $K^* = \{ x \in H : \ip{x}{y} \geq 0, \quad \forall y\in K\} $. Assume $T:K \to H$. The complementarity problem $CP(T,K)$ is the problem of finding an element $x$ such that
  \begin{equation}
    \begin{split}
    \ip{x}{Tx} = 0 \\
    Tx \in K^*, \quad  x\in K
  \end{split}
  \end{equation}
\end{definition}
With \Cref{def:comp_prob} we can write \Cref{eq:KKT_total} as an equivalent family of complementarity problems. Introduce $K = H_+ \osum \R$, with $K^* = H_+ \osum \{0\}$ and define
\begin{equation}
  T(\sigma_i, \lambda) = (-\nabla_{\sigma_i} U_i \mid{\sigma_i = \overbar{\sigma}_i} - \lambda_i \cdot 1_H, 0)
\end{equation}
Then the equations in \Cref{eq:KKT_total} can be recast as finding $(\sigma_i,\lambda_i) \in K$ such that:
\begin{equation}
  \label{eq:comp_form}
  \begin{split}
    \ip{T}{(\sigma_i,\lambda_i)} = 0 \\
    T((\sigma_i,\lambda_i) \in K^*
  \end{split}
\end{equation}
Or, equivalently:
\begin{equation}
  \begin{split}
    \ip{\sigma_i}{-\nabla_{\sigma_i} U_i \mid{\sigma_i = \overbar{\sigma}_i} - \lambda_i \cdot 1_H} + \ip{\lambda_i}{0}= 0 \\
    \pa{-\pa{\nabla_{\sigma_i} U_i \mid{\sigma_i = \overbar{\sigma}_i} - \lambda_i \cdot 1_H}, 0} \in K
  \end{split}
\end{equation}
There are dedicated tools available allowing for fast numerical resolution of complementarity problems \citep{acary2019introduction, dirkse1995path}. There is still the problem of establishing existence and uniqueness of the solution to this complementarity problem, which is generally hard, \citep{hadjisavvas2006handbook}.


%If $K$ is a convex cone, the problems $VI(T,K)$ and $CP(T,K)$ have the same solutions, which can be seen by setting $y=2x$ and $y=0$ respectively.

%To motivate the approach based on complementarity and variational inequalities,

%To put the problem of finding the Nash equilibrium into the terms of a complementarity problem, we generalize the strategy of \Cref{prop:doubleup}.
\begin{comment}
\begin{equation}
  \begin{split}
  \nabla_{\sigma_i}U_i((\sigma_j)_{j=1}^M) \mid_{\sigma_i = \overbar{\sigma}_i}  + \mu_i - \lambda  \cdot 1_H = 0 \\
  \ip{\sigma_i}{\mu_i} = 0 \\
  \mu_i \in H_+ \\
  \sigma_i \in H_+ \\
  \int_X \sigma_i d\mu(x)- 1 = 0
\end{split}
\end{equation}
\end{comment}
%Thus the condition for the Nash equilibrium of the total population as in \Cref{eq:tot_nash_eq} is:
\begin{comment}
The family of complementarity problems in \Cref{eq:comp_form} can be gathered into a single complementarity problem. We define $dU = \begin{pmatrix} \nabla_{\sigma_1} U_1 \mid_{\sigma_1 = \overbar{\sigma}_1}\\
    \vdots \\
    \nabla_{\sigma_N} U_N \mid_{\sigma_N = \overbar{\sigma}_N} \end{pmatrix}$, $S=(\sigma_i)_{i=1}^M$, and $\Lambda = (\lambda_i)_{i=1}^M$. Then \Cref{eq:KKT_total} can be restated as
\begin{equation}
  \label{eq:complementarity_form}
  \ip{dU(S)+\Lambda}{S} = 0 \\
  \ip{S_i-1}{1}\Lambda = 0
  -dU(S)-\Lambda \geq 0 \\
  \ip{S_i-1}{1} \in \{0 \}
  S\geq 0
  \Lambda \in \R^M
\end{equation}
which is a complementarity problem with $K = (H_+ \osum \R)^M$, $K^* = (H_+ \osum \{0\})^M$ and
\begin{equation}
  T(S,\lambda)=\begin{pmatrix} dU(S) + \Lambda \\ (\ip{\sigma_i}{1} - 1)_{i=1}^M \end{pmatrix}
\end{equation}
\end{comment}
\subsection{Restatement as a variational inequality}
We have recast the problem of finding a Nash equilibrium to a complementarity problem, which allows for numerical resolution. To establish existence and uniqueness, we need to use the relationship between complementarity problems and variational inequalities. We will show that in case the payoff-functions $U_i $ are sufficiently nice, the machinery of variational inequalities can be applied to show existence and uniqueness of the Nash equilibrium.

%Asking for convexity is too strong, but it turns out the weaker notion of strict pseudoconvexity is sufficient. See \Cref{sec:appendix} for further details.
We define a variational inequality:
\begin{definition}
  Let $H$ be a real Hilbert space and $K\subset H$ be a non-empty convex subset of $H$. Let $T: K \to H$. The variational inequality $VI(T,K)$ is the following system
  \begin{equation}
    x \in K, \ip{y-x}{Tx} \geq 0, \quad \forall y \in K
  \end{equation}
\end{definition}
The relationship between variational inequalities and complementarity problems is captured in \citep[Proposition 12.1]{hadjisavvas2006handbook}:
\begin{proposition}
  \label{prop:VI_CP_eq}
  Let $K\subset H$ be a convex cone, and $T: K \to H$. Then the variational inequality $VI(T,K)$ is equivalent to the complementarity problem $CP(T,K)$.
\end{proposition}
\begin{proof}
  Clearly, a solution $x^*$ to $CP(T,K)$ is also a solution to $VI(T,K)$. For the other direction, assume that we have a solution $x^*$ to VI(T,K). Then
  \begin{equation}
    \ip{y - x^*}{Tx^*} \geq 0 \forall y \in K
  \end{equation}
  Setting $y = 2x^*$, we arrive at $\ip{x^*}{Tx^*} \geq 0$, and setting $y=0$ we arrive at $\ip{x^*}{Tx^*} \leq 0$. This shows the desired equivalence.
\end{proof}
We can now turn the problem finding a Nash equilibrium into a variational inequality. Consider the problem as stated in \Cref{eq:comp_form}. This is a complementarity problem over the convex cone $H_+ \osum \R$. Hence it is equivalent to a variational inequality over the same convex cone with $T$ as in \Cref{eq:comp_form}
\begin{equation}
  \ip{T}{(\sigma_i' -\sigma_i,\lambda_i'-\lambda_i)} \geq 0, \quad \forall (\sigma_i', \lambda_i') \in K
\end{equation}
Since the second coordinate of $T$ is identically zero, this is the same as finding $(\sigma,\lambda)$ such that
\begin{equation}
  \label{eq:simp_var_eq}
  \ip{-\nabla_i U_i \mid_{\sigma_i = \overbar{\sigma}_i} - \lambda_i}{\sigma_i' -\sigma_i} \geq 0 \quad \forall \sigma_i' \in K
\end{equation}
In our theoretical considerations, we want to rid ourselves of the term $\lambda_i$, which stems from the constraint $\int_X \sigma_i d\mu = 1$. Hence solving \Cref{eq:simp_var_eq} over $K$ is equivalent to solving the constrained problem:
\begin{equation}
  \ip{-\nabla_i U_i \mid_{\sigma_i = \overbar{\sigma}_i}}{\sigma_i' -\sigma_i} \geq 0, \quad \sigma_i' \in P_{2,\mu}
\end{equation}
We can now state the problem of finding the Nash equilibrium \Cref{eq:tot_nash_eq} as finding the solution of a variational inequality.
\begin{definition}[Nash equilibrium as variational inequality]
  \label{def:var_eq_nash}
  Defining
\begin{equation}
  dU = \begin{pmatrix} \nabla_{\sigma_1} U_1 \mid_{\sigma_1 = \overbar{\sigma}_1}\\
      \vdots \\
      \nabla_{\sigma_N} U_N \mid_{\sigma_N = \overbar{\sigma}_N} \end{pmatrix}
\end{equation}
the problem of determining the Nash equilibrium \Cref{eq:tot_nash_eq} is the variational inequality of finding a vector $S = (\sigma_i)_{i=1}^M$ such that:
\begin{equation}
  \ip{-dU(S)}{W-S} \geq 0 \quad \forall W\in P_{2,\mu}^M
\end{equation}
\end{definition}
%i.e. solves a variational inequality. %Searching for a solution to a variational inequality is more tractable for theoretical considerations, while the complementarity formulation is preferable for solving the problem numerically.

%In case the payoff-functions $U_i $ are sufficiently nice, the machinery of variational inequalities can be applied to show existence and uniqueness of the Nash equilibrium. Asking for convexity is too strong, but it turns out the weaker notion of strict pseudoconvexity is sufficient. See \Cref{sec:appendix} for further details.
We need to introduce a specific type of variational inequality, which generalizes strict monotonicity of an operator, before we can state and prove a general theorem for uniqueness of the Nash equilibrium.
\begin{definition}
  \label{def:strict_pm}
 The operator $T: K \to H$ is strictly pseudomonotone if for every pair $x\neq y$ we have
 \begin{align}
   \ip{x-y}{Ty} \geq 0 \Rightarrow \ip{x-y}{Tx} > 0
 \end{align}
\end{definition}
With \Cref{def:strict_pm} in hand, we can finally give sufficient criteria for existence and uniqueness of the Nash equilibrium of the game specified in \Cref{eq:tot_nash_eq}.
\begin{theorem} \label{thm:nash_unique}
  Consider a game with $M$ players with payoff functions $U_i$ the total operator $dU$ is strictly pseudomonotone. Assume the strategies $\sigma_i$ are in $P_{2,\mu}$. The game has a unique Nash equilibrium if $dU$ as in \Cref{def:var_eq_nash} satisfies the criterion of \Cref{thm:existence} or $H$ is finite dimensional.
\end{theorem}
\begin{proof}
   If each $\nabla_{\sigma_i} U_i \mid_{\sigma_i = \overbar{\sigma}_i}$ is strictly pseudomonotone, then so is $dU$ by bilinearity of the inner product. By \Cref{thm:uniqueness} any Nash equilibrium will be unqiue since $dU$ is strictly pseudomonotone. So if the solution exists, it is unique. By assumption \Cref{thm:existence} gives existence of a solution of $VI(dU,P_{2,\mu}^M)$ in case $H$ is infinite dimensional. If $H$ is finite-dimensional then $P_{2,\mu}^M$ is compact and there exists a solution \Cref{rem:weak_compact}. \qed
\end{proof}
As a consequence of \Cref{thm:nash_unique}, we can introduce an equilibrium between the Nash equilibria of a mean-field game and a game with monomorphic populations.
%If the payoff functions Â¤U_ mean-field game has a family of functions $U_i^{mon}$ satisfying $\nabla_{\sigma_i} U_i\mid{\sigma_i = \overbar{\sigma}_i} = \nabla_{\sigma_i} U_i^{mon}$, then the monomorphic game defined $U_i^{mon}$ has the same Nash equilbria as the original game.
\begin{definition}
  \label{def:correspondence}
  Consider a mean-field game with populations $N_1,\dots,N_M$ with individual payoffs $U_i(\sigma_i, (N_j \overbar{\sigma}_j)_{j=1}^M)$. Assume $\nabla_{\sigma_i}U_i\mid_{\sigma_i=\overbar{\sigma}_i}$ admits a primitive $U_i^{mon}$ such that $\nabla_{\sigma_i} U_i\mid{\sigma_i = \overbar{\sigma}_i} = \nabla_{\sigma_i} U_i^{mon}$.
   We define the monomorphic equivalent game as the game with monomorphic populations specified by the payoff functions $U_i^{mon}$.
\end{definition}
The reason this result is interesting is
\begin{theorem}[Theorem 12.13, p. 521 \citep{hadjisavvas2006handbook}]
  \label{thm:strictly_pseudoconvex}
  Let $\Omega \subset H$ be an open convex subset, and let $f:\Omega \to \R$ be Gateaux differentiable. Then $f$ is strictly pseudoconvex if and only if $\nabla f$ is strictly pseudomonotone.
\end{theorem}
so for uniqueness instead of considering $-\nabla U_i \mid_{\sigma_i = \overbar{\sigma}_i}$ we can consider $-U_i$ directly. That is, if a monomorphic equivalent game exists, it becomes possible to study the monomorphic game instead and use strict pseudoconvexity to establish strict pseudomonotonicity.

With \Cref{thm:nash_unique}, we can show that there exist unique fixed points of population games where $dU$ is strictly pseudomonotone, e.g. in a population game with strictly pseudoconvex monomorphic equivalent payoff function and bounded dynamics.
\begin{theorem}
  \label{thm:pop_game_exists_unique}
  We have a population game with $M$ populations of size $N_i$, payoff functions $U_i(\sigma_i, (N_j \overbar{\sigma}_j)_{j=1}^M)$ and dynamics given by $f_i(N_j \overbar{\sigma}_j)_{j=1}^M))$:
  \begin{equation}
    \dot{N_i} = N_i f_i
  \end{equation}
  Assume that the that the set of stationary points of the population dynamics is uniformly bounded in $(\sigma_i)_{i=1}^M$ and convex, and that the stationary points are continuous in $(\sigma_i)_{i=1}^M$. Let $\nabla_{\sigma_i} U_i \mid_{\sigma_i = \overbar{\sigma}_i}$ be strictly pseudomonotone and satisfy \Cref{thm:existence}. Then the population game has a fixed point.

  A sufficient conditions for uniqueness and stability of the fixed-point is that there exists an $M>0$ the total operator $-(N_if_i)_{i=1}^M \osum -MdU$ is strictly pseudomonotone for all $N \geq M$.
\end{theorem}
\begin{proof}
  The game specified by the family $(U_i)_{i=1}^M$ has a unique Nash equilibrium for each $x\in \R^M$, given by a variational inequality problem over $P_{2,\mu}^M$ with operator $-dU$. The solution operator is a continuous mapping $G: \R_+^M \to P_{2,\mu}^M$, due to the existence and uniqueness of the solution \Cref{thm:nash_unique} \cite[Theorem 4.2]{barbagallo2009continuity}. By assumption, the fixed-point mapping $F_i$ for the population dynamics is continuous in $(\sigma_i)_{i=1}^M$.

  Finding a fixed point of the dynamical system along with a Nash equilibrium then corresponds to finding a fixed point of $F\circ G: \R_+^M \to \R_+^M$. Since the set of stationary points is assumed bounded, $G$ has compact range, and $F\circ G$ has compact image. Therefore $F\circ G:\R_+^M \to \R_+^M$ has a fixed point $(x_1^*, \dots, x_m^*)$ by Schauder's fixed point theorem \citep[Theorem 3.2, p. 119]{granas2003elementary}. Likewise, the map $G\circ F:P_{2,\mu}^M \to P_{2,\mu}^M$ has a fixed point $(\sigma_1^*,\dots, \sigma_M^*)$, since it factorizes through a compact space. We can conclude that a fixed-point exists, hence a combined Nash and population equilibrium.

  To show uniqueness and stability, we need to shift perspectives. Since $-dU$ is strictly pseudomonotone, so is $-MdU$ for any $M$. Define the projection $\Pi$ from $H$ to $P_{2,\mu}$. Then the dynamical system
  \begin{equation}
    \dot{\sigma}_i = \Pi(-dU_i((\sigma)_{i=1}^M)))
  \end{equation}
  converges asymptotically to the Nash equilibrium \citep{}. The population dynamical system with instantanous Nash equilibrium is then equivalent to the system:
  \begin{equation}
    \label{eq:instant_nash_DE}
    \dot{N_i} = N_i f_i
    \lim_{\epsilon \to 0}\epsilon\dot{\sigma}_i = \Pi(-dU_i((\sigma)_{i=1}^M)))
  \end{equation}
  Since the first set of equations stays in the positive orthant where can introduce the projection operator $\Pi_R$, the system can be rewritten as
  \begin{equation}
    \dot{N_i} = \Pi_R(-(-N_i f_i))
    \eps\dot{\sigma}_i = \Pi(-dU_i((\sigma)_{i=1}^M)))
  \end{equation}
  This system converges asymptotically if the operator
  \begin{equation}
    \label{eq:de_sys}
    (-N_i f_i)_{i=1}^M \osum (\frac{1}{\epsilon}-dU)
  \end{equation}
  is strictly pseudomonotone. If there exists an $N$ such that \Cref{eq:de_sys} is strictly pseudomonotone, hence asymptotically stable, for all $\frac{1}{\epsilon}>N$, then \Cref{eq:instant_nash_DE} is also asymptotically stable.
    \qed

\end{proof}
Having established the general theory for Nash equilibria, and demonstrated how to handle mean-field games as monomorphic games, we are ready to apply the theory to a Rosenzweig-MacArthur system with fast adaptive behavior.
\section{Revisiting the Rosenzweig-MacArthur model}
\label{sec:model_rm}
%Having established the general framework, we can proceed to defining the concrete model of interest.
We consider a predator-prey system modeled as a Rosenzweig-MacArthur system, where the predators are specialized so that their hunting success is maximal in the most productive zone of the habitat.
We assume that predators $(N_p)$ and consumers $(N_c)$ inhabit the interval $[0,1]$, with $P_{2,\mu}$ as square-integrable probability densities on $[0,1]$. The mean strategies of the predator and consumer populations are $\overbar{\sigma}_c$, and $\overbar{\sigma}_p$ respectively. We assume a consumer population with a Type I functional response foraging in an environment with a heterogeneous carrying capacity. We model this as a carrying capacity $K_0 + K \phi$ where $K_0$ is the minimal carrying capacity, $K$ is the varying capacity and $\phi$ is a probability density function. In the model, we set  $\phi = \frac{\exp(-3 x)}{\int_0^1 \exp(-3 x) dx}$.

We assume that the maximal potential growth for a consumer from a location depends both on the carrying capacity and how many consumers are already occupying the spot. With this in mind, the pr. capita consumer growth term $G_c$ is
\begin{equation}
  G_c(N_c, \overbar{\sigma}_c) = \pa{\ip{\overbar{\sigma}_c}{1-N_c \frac{\overbar{\sigma}_c}{K\phi + K_0}}}
\end{equation}

The predator clearance rate is $\beta_p = \beta_{l} + \beta_0$ where $\beta_l$ varies locally and $\beta_0$ is the minimal clearance rate. Concretely, we set $\beta_p(x) = \frac{1}{2}5 \frac{\exp(-(3 x)^2)}{\int_0^1 \exp(-(3 x)^2) dx} + \beta_0$. The chosen function models a predator specialized in hunting in the most productive zones, but with non-zero hunting success everywhere. We assume the maximal predator consumption rate is $F_p$, and the predators have a conversion efficiency of $\epsilon$. Consumption events are assumed local, so the expected encounter rate between predators and prey is $N_c N_p \ip{\beta_p \overbar{\sigma}_p}{\overbar{\sigma}_c}$. We assume that predators have a Type II functional response, and their consumption is limited by prey-capture and digestion rather than handling, which causes a non-linearity in the functional response as a function of the strategy \citep{Kioerboe2018}. This gives a pr. capita predator growth rate $G_p$:
\begin{equation}
  G_p(N_p, \overbar{\sigma}_p, N_c, \overbar{\sigma}_c )= \epsilon\frac{F_p \ip{\beta_p N_c\overbar{\sigma}_c}{\overbar{\sigma}_p} }{F_p + \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c}
\end{equation}
This allows us to define the pr. capita consumer mortality $M_c = \frac{N_p}{\epsilon N_c}G_p$. Predator mortality stems both from a metabolic loss $\mu_p$ and intraspecific predator competition, which we assume leads to a Type I loss for predators as there is no satiation. We assume that predators are more competitive in the area where they are best specialized for hunting. Introducing a competition parameter $c$, the pr. capita predator mortality $M_p$ is:
\begin{equation}
  M_p(N_p, \overbar{\sigma}_p) =  c \ip{\overbar{\sigma}_p}{N_p\beta_p \overbar{\sigma}_p}  - \mu_p
\end{equation}
Defining the pr. capita dynamics $f_c = G_c - M_c$ and $f_p = G_p - M_p$, we can write the dynamical system as:
\begin{equation}
  \label{eq:dynamics}
  \begin{split}
    \dot{N_c} &= N_c f_c \\
    \dot{N_p} &= N_p f_p
  \end{split}
\end{equation}
The population dynamics in \cref{eq:dynamics} are a modified Rosenzweig-MacArthur system, where behavior of both consumer and predator populations has been incorporated.
\subsection{The instantaneous game}
As in \Cref{sec:general_setting} we model predator and consumer movement as instantaneous. Each predator and consumer seeks to maximize its growth at every instant. Denote the strategies of a focal consumer and predator by $\sigma_c$ and $\sigma_p$ respectively.  The growth of the focal individual depends on the mean-field strategies of both predators and consumers, and can be arrived at by modifying the expressions for $G_c,M_c$ and $G_p, M_p$ carefully.
The growth $G_c^{ind}$ of an individual consumer is
\begin{equation}
  G_c^{ind} = \ip{\sigma_c}{1-N_c \frac{\overbar{\sigma}_c}{K\phi + K_0}}
\end{equation}
as the initial growth term depends on the choices of the consumer, while the available food depends on the distribution of the population. The loss from predation for an individual is more complex, since the encounter with a predator depends on the strategy of the focal consumer, while the satiation of the predator depends on how many total consumers it encounters, hence the population mean. The individual mortality $M_c^{ind}$ is
\begin{equation}
  M_c^{ind} =  \frac{F_p \ip{\beta_p \sigma_c}{\overbar{\sigma}_p} N_p}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c}
\end{equation}
Going to a focal predator, the growth $G_p^{ind}$ of an individual predator has the same expression as the pr. capita growth, since the satiation has no dependence on the overall predator population.
\begin{equation}
  G_p^{ind} = \epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}
\end{equation}
The individual predator mortality $M_p^{ind}$ depends on both the choice of the individual and the distribution of the entire predator population.
\begin{equation}
  M_p^{ind} =  c \ip{\sigma_p}{N_p\beta_p \overbar{\sigma}_p}  - \mu_p
\end{equation}
The instantaneous growth rates $U_c,U_p$ for an individual consumer and predator are:
\begin{align}
  U_c(\sigma_c, N_c \overbar{\sigma}_c, N_p\overbar{\sigma}_p) &=  G_c^{ind} - M_c^{ind} \\
  U_p(\sigma_p, N_p \overbar{\sigma}_c, \overbar{\sigma}_p) &= G_p^{ind} - M_p^{ind}
\end{align}
We convert both mean-field payoffs into a monomorphic equivalent form as in \cref{def:correspondence}
\begin{align}
  \label{eq:mon_eq_forms}
  U_c^{mon}(\sigma_c, \sigma_p, N_c, N_p) &= \ip{\sigma_c}{1-\frac{1}{2}\frac{\sigma_c N_c}{K\phi + K_0}}\\ &- \frac{N_p}{N_c}\log\pa{F_p + \ip{\beta_p \sigma_c}{\sigma_p} N_c} \\
  U_p^{mon}(\sigma_p, \sigma_c, N_c, N_p) &= \epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}{F_p + \ip{\beta_p \sigma_c}{\sigma_p} N_c} - \frac{1}{2}c \ip{\sigma_p}{\beta_p \sigma_p}N_p  - \mu_p
\end{align}
\subsection{Existence and uniqueness of Nash and population equilibria}
In order to establish existence and uniqueness of the Nash equilibrium we show that the variational inequality defined by $dU$ is strictly pseudomonotone and admits a solution. Before we can show this, we need small lemma to reduce the complexity of the problem.
\begin{lemma}
  \label{lem:pseudo_reduc}
  A function $g: P_{2,\mu} \to H$ is pseudomonotone if and only if $g+\lambda$ is pseudomonotone for any $\lambda \in \R$.
\end{lemma}
\begin{proof}
  Consider $\ip{g(x)+\lambda}{x-y}=\ip{g(x)}{x-y}+\lambda \int x d\mu - \lambda \int y d\mu$
  Using that $\int y d\mu = \int x d\mu = 1$, we arrive at  $\ip{g(x)}{x-y}$.
  Hence the pseudomonotonicity of $g$ and $g+\lambda$ are equivalent.
\end{proof}
We start by showing that there is a unique Nash equilibrium for the cases where the predator and consumer respectively have constant behavior, i.e. $\sigma_i = 1,~i\in \{c,p\}$.
\begin{proposition}
  There is a unique mean-field Nash equilibrium in the Rosenzweig-MacArthur system where the consumers have adaptive behavior and predators have constant behavior $\sigma_p = 1$.
  Likewise, there is a unique Nash equilibrium in the Rosenzweig-MacArthur system where the predators have optimal behavior and the consumers have constant behavior $\sigma_c = 1$.
\end{proposition}
\begin{proof}
  To show the uniqueness of the Nash equilibrium when the consumers have optimal behavior, consider $dU_c = \nabla_{\sigma_c} U_c^{mon}$.  By \Cref{lem:pseudo_reduc} it suffices to show that $f = -dU_c + 1$ is strictly pseudomonotone.
  For \Cref{lem:strict_pm} assume $\ip{f((\sigma_c))}{h} = 0$, then
  \begin{equation}
    \begin{split}
      \ip{f(x)}{h} &= \\
      \ip{\sigma_c \frac{N_c}{K\phi + K_0} }{h} + \frac{N_p F_p \ip{\beta_p }{h}}{F_p + \ip{\beta_p}{\sigma_c}} - \ip{1}{h} + \ip{1}{h}
    \end{split}
  \end{equation}
  Since $K\phi + K_0$ and $\beta_p$ are everywhere positive, $\ip{\beta_p}{h} = 0$ and $\ip{\sigma_c \frac{N_c}{K\phi + K_0}}{h} = 0$. Then consider $H((\sigma_c,h)= \ip{(\nabla f)((\sigma_c,\sigma_p))h}{h}$, where $\ip{f(x)}{h} = 0$. We calculate $\nabla f$:
    \begin{equation}
      \nabla f = \begin{pmatrix} \frac{N_c}{K \phi + K_0} - \frac{F_p^2\beta_p}{(F_p + \ip{\beta_p \sigma_p}{\sigma_c})^2} \\
    \end{pmatrix}
    \end{equation}
    Since $\ip{\sigma_p}{h}=0$ and $\frac{N_c}{K\phi + K_0}$ is everywhere positive, we conclude $H(x,u)>0$. Therefore $f$ is strictly pseudomonotone by \Cref{lem:strict_pm}, and $-U_c^{mon}$ is strictly pseudoconvex.

    The situation for the predators is even simpler, since $-U_p^{mon}$ is strictly convex, hence strictly pseudoconvex. By \Cref{thm:strictly_pseudoconvex} this entails that $-dU_p$ is strictly pseudomonotone, so the Nash equilibrium is unique.
    The existence of the Nash equilibria follows from the proof of existence in \Cref{prop:exist_unique_nash}.
\end{proof}
Having shown that each of the underlying mean-field games has a unique Nash equilibrium, we can consider the total game.
\begin{proposition}
  \label{prop:exist_unique_nash}
  The game defined by $U_c$ and $U_p$ has a unique Nash equilibrium for every non-zero pair $N_c,N_p$.
\end{proposition}
\begin{proof}
  We need to show that the variational inequality defined by the function
  \begin{equation}
    \label{eq:var_ineq}
    dU = \begin{pmatrix}-\nabla_{\sigma_c} U_c^{mon} \\ -\nabla_{\sigma_p} U_p^{mon}\end{pmatrix}
  \end{equation} satisfies the criteria of \Cref{thm:existence} and is strictly pseudomonotone.
  To show that there exists a solution, start by noting that for all $S\in H^2$, $S\mapsto -dU(S)$ is Lipschitz continuous, hence continuous on finite-dimensional subspaces, fulfilling the first criterion of \Cref{thm:existence}. For the second criterion, consider
  \begin{equation}
    \label{eq:du}
    \ip{-dU(\sigma_c,\sigma_p)}{(\sigma_c-1, \sigma_p-1)}
  \end{equation}
  We relegate the calculations to the appendix \Cref{appendix:calculations}, but we conclude
  \begin{equation}
    \label{eq:fin_exist}
    \ip{-dU(\sigma_c,\sigma_p)}{(\sigma_c-1, \sigma_p-1)} \geq C_1\norm{\sigma_c}_2^2 + C_2\norm{\sigma_p}_2^2 - W(\sigma_c,\sigma_p)
  \end{equation}
  where $W$ is uniformly bounded on $P_{2,\mu}^2$, and $C_1,C_2$ strictly positive. Recall that constraining the problem to $P_{2,\mu}$ is equivalent to $\norm{\sigma_c}_1 = 1, \norm{\sigma_p} = 1$. Hence \Cref{eq:fin_exist} tends to infinity as $\norm{(\sigma_c,\sigma_p)}_2$ tends to infinity. Therefore \Cref{eq:du} is only negative on a bounded subset of $P^2_{2,\mu}$, showing existence of a solution to the variational inequality defined by the function \Cref{eq:var_ineq}, \Cref{thm:existence}.

  To show strict pseudomonotonicity, we again apply \Cref{lem:strict_pm}. Assume that
  \begin{equation}
    \ip{-dU((\sigma_c,\sigma_p))}{(h_1, h_2)} = 0
  \end{equation}
  Re-arranging gives:
  \begin{equation}
    \label{eq:h1_h2_rel}
    \frac{\epsilon \ip{\beta_p \sigma_c}{h_2} N_c}{(F_p + \ip{\sigma_c}{\sigma_p}N_c)^2} = c\ip{\beta \sigma_p}{h_2}N_p + \ip{\frac{\sigma_c}{K}}{h_1} + \frac{\ip{\beta_p \sigma_p}{h_1} N_p}{(F_p + \ip{\sigma_c}{\sigma_p}N_c)}
  \end{equation}
  Then consider
  \begin{equation}
    \label{eq:hess_mat}
    H(x) = (\nabla -dU)(x) = \begin{bmatrix}  \end{bmatrix}
  \end{equation}
  We then need to show that $\ip{H(x)h}{h}>0$. This is done by inserting \Cref{eq:h1_h2_rel} in $\ip{H(x)h}{h}$ as this allows cancellation of the negative terms in $\ip{H(x)h}{h}$, but we relegate the explicit calculations to \Cref{appendix:calculations}. This shows the desired.
  \qed
\end{proof}
As we are interested in the fixed-points of the population dynamics \Cref{eq:dynamics}, we show that a fixed-point of the population dynamics exists and is unique.
\begin{corollary}
  The population game \Cref{eq:dynamics} has a unique fixed point.
\end{corollary}
\begin{proof}
Both $f_c$ and $f_p$ are strictly monotone, hence strictly pseudomonotone. Due to the metabolic terms and logistic terms set of fixed-points of these are uniformly bounded in $\sigma_c, \sigma_p$. By \Cref{prop:exist_unique_nash} the Nash equilibrium exists and is unique for every $N_c, N_p$. The operator $(M-dU_c, -MdU_p, -N_c f_c, -N_p f_p)$ can be shown to be strictly pseudomonotone in an entirely anaoglous fashion as $(-dU_c, -dU_p)$, and we omit the calculations. Therefore, by \Cref{thm:pop_game_exists_unique} there is a unique stable equilibrium for the population game.% for parameters when coexistence is possible.
\qed
\end{proof}
