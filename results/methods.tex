\section{Nash equilibria and variational inequalities}
Calculating Nash equilibria is generally a hard problem. A fruitful approach to calculating Nash equilibria is via. the theory of complementarity problems and variational inequalities \citep{karamardian1969nonlinear,nabetani2011parametrized}. We unite the approach of variational inequalities and mean-field games which allows us to characterize a situation that guarantees uniqueness and existence of Nash equilibria in population games, and the existence of fixed-points of these games.

%We develop the theory for monomorphic games, and finally introduce a method to analyze a mean-field game as a monomorphic game.

As in \Cref{sec:general_setting}, our habitat is a measure space $(X,\mu)$ with $M$ different types inhabiting it with payoff-functions $U_i$. The simplest example our framework needs to handle is that of a single type with population $N$ inhabiting $X$ with foraging distribution $\sigma$. The encounter rate of an individual following the strategy $\sigma$ with the entire population also following the strategy $\sigma$ has the density $N\sigma^2$. The expected encounter rate then becomes
\begin{equation}
  \int_X \sigma^2 d\mu
\end{equation}
and this quantity must be finite, hence the appropriate setting for our work is the space $L^2(X)$.
\begin{definition}
  Define $H$ as the real Hilbert space $L^2(X)$, where $X$ is a measure space. Define $H_+ \subset H$ as the a.e. positive functions in $H$.
\end{definition}
Finding Nash equilibria is one of the oldest applications of complementarity theory \citep{karamardian1969nonlinear}. We define a complementarity problem:
\begin{definition}
  Let $H$ be a real Hilbert space, and $K \subset H$ be a closed convex cone. Define $K^* = \{ x \in H : \ip{x}{y} = 0, \quad \forall y\in K\} $. Assume $T:K \to H$. The complementarity problem $CP(T,K)$ is the problem of finding an element $x^*$ such that
  \begin{equation}
    \begin{split}
    \ip{x^*}{Tx^*} = 0 \\
    Tx \in K^*, \quad  x\in K
  \end{split}
  \end{equation}
\end{definition}
As a general rule showing existence and uniqueness for complementarity problems is hard, which is where their relationship to variational inequalities comes in handy.
\begin{definition}
  Let $H$ be a real Hilbert space and $K\subset H$ be a non-empty subset of $H$. Let $T: K \to H$. The variational inequality $VI(T,K)$ is the following system
  \begin{equation}
    x \in K, \ip{y-x}{Tx} \geq 0, \quad \forall y \in K
  \end{equation}
  and a solution is an $x$ satisfying the inequality.
\end{definition}
%If $K$ is a convex cone, the problems $VI(T,K)$ and $CP(T,K)$ have the same solutions, which can be seen by setting $y=2x$ and $y=0$ respectively.

To motivate the approach based on complementarity and variational inequalities, assume that we have a mean-field game with $M$ players, payoff functions $U_i$, and strategies $\sigma_i, \overbar{\sigma}_i$. At the Nash equilibrium, each payoff function $U_i$ must satisfy the Karush-Kuhn-Tucker (KKT) conditions with respect to $\sigma_i$, along with $\overbar{\sigma}=\sigma$ as in \Cref{eq:mfg_ne}.
\begin{align}
  \nabla_{\sigma_i}U_i((\sigma_j)_{j=1}^M) \mid_{\sigma_i = \overbar{\sigma}_i}  + \mu_i - \lambda \cdot 1 = 0
  \ip{\sigma_i}{\mu_i} = 0
  \mu_i \geq 0
  \sigma_i \geq 0
  \int_X \sigma_i - 1 = 0
\end{align}
Remark that the last two conditions are equivalent to requiring that $\sigma \in P_{\mu}(X) \cap H$. This motivates the definition:
\begin{definition}
  Given a measure space $(X,\mu)$ with a corresponding space of square-integrable functions $H=L^2(X,\mu)$ and space of probability measures which are absolutely continuous with respect to $\mu$, $P_{\mu}$. Define the space $P_{2,\mu}=H \cap P_{\mu}$ consisting of absolutely continuous square-integrable probability densities.
\end{definition}

The Nash equilibrium of the game specified by the family $(U_i)$ corresponds to finding a system $\sigma_i^*$ satisfying the KKT conditions simultaneously for every pair $U_i$, \citep{deimling2010nonlinear}. Thus the condition for the Nash equilibrium of the total population as in \Cref{eq:tot_nash_eq} is:
\begin{equation}
  \begin{split}
  \begin{pmatrix}
    \nabla_{\sigma_1} U_1 \mid{\sigma_1 = \overbar{\sigma}_1} \\
    \vdots \\
    \nabla_{\sigma_N} U_N \mid{\sigma_N = \overbar{\sigma}_N}
\end{pmatrix} + \begin{pmatrix}
    \mu_1 \\
    \vdots \\
    \mu_N
\end{pmatrix} + \begin{pmatrix}
    \lambda_1 \cdot 1_k \\
    \vdots \\
    \lambda_N \cdot 1_k
\end{pmatrix} = 0 \\
\ip{
\begin{pmatrix}
  \mu_1 \\
  \vdots \\
  \mu_N
\end{pmatrix}}{ \begin{pmatrix}
  \sigma_1 \\
  \vdots \\
  \sigma_N
\end{pmatrix}} = 0 \\
\mu_i \geq 0 \\
  \sigma_i \geq 0 \\
    \sigma \in P_{2,\mu}(X)
    \label{eq:KKT_total}
  \end{split}
\end{equation}
To simplify \Cref{eq:KKT_total}, we define $dU = \begin{pmatrix} \nabla_{\sigma_1} U_1 \\
    \vdots \\
    \nabla_{\sigma_N} U_N \end{pmatrix}$, $S=(\sigma_i)_{i=1}^M$, and $\Lambda = (\lambda_i)_{i=1}^M$. Then the problem can be restated as
\begin{equation}
  \label{eq:complementarity_form}
  \ip{dU(S)+\Lambda}{S} = 0 \\
  \ip{S_i-1}{1}\Lambda = 0
  -dU(S)-\Lambda \geq 0 \\
  \ip{S_i-1}{1} \in \{0 \}
  S\geq 0
  \Lambda \in \R^M
\end{equation}
which is a complementarity problem with $K = (H_+ \osum \R)^M$, $K^* = (H_+ \osum \{0\})^M$ and
\begin{equation}
  T(S,\lambda)=\begin{pmatrix} dU(S) + \Lambda \\ (\ip{\sigma_i}{1} - 1)_{i=1}^M \end{pmatrix}
\end{equation}
If we do not include the criterion $\int \sigma_i dx = 1$ as a Lagrange multiplier, but instead optimize over the convex set $P_\mu(X)$, the problem  becomes finding a vector $S = (\sigma_i)_{i=1}^M$ that minimizes
\begin{equation}
  \ip{dU(S)}{S-T} \geq 0 \forall T\in P_{2,\mu}^M
\end{equation}
i.e. solves a variational inequality. Searching for a solution to a variational inequality is more tractable for theoretical considerations, while the complementarity formulation is preferable for solving the problem numerically.

In case the payoff-functions $U_i $ are sufficiently nice, the machinery of variational inequalities can be applied to show existence and uniqueness of the Nash equilibrium. Asking for convexity is too strong, but it turns out the weaker notion of strict pseudoconvexity is sufficient. See \Cref{sec:appendix} for further details.

We can gather the results on pseudoconvex functions and their application to game theory in the following theorem:
\begin{theorem} \label{thm:nash_unique}
  Consider a game with $M$ players with strictly pseudoconvex payoff functions $U_i$ and strategies $\sigma_i$ in $P_{2,\mu}$. The game has a unique Nash equilibrium if
  \begin{equation}
    dU=
    \begin{pmatrix}
      \nabla_{\sigma_1} U_1\mid{\sigma_1 = \overbar{\sigma}_1}\\
      \vdots \\
      \nabla_{\sigma_N} U_N \mid{\sigma_N = \overbar{\sigma}_N}
    \end{pmatrix}
  \end{equation}
  satisfies the criterion of \Cref{thm:existence} or $H$ is finite dimensional.
\end{theorem}
\begin{proof}
   If each $\nabla_{\sigma_i} U_i$ is strictly pseudomonotone, then so is their direct sum $dU$ by bilinearity of the inner product. By \Cref{thm:uniqueness} this solution is unique since $dU$ is strictly pseudomonotone. So if the solution exists, it is unique. By assumption \Cref{thm:existence} gives existence of a solution of $VI(dU,P_{2,\mu}^M)$ in case $H$ is infinite dimensional. If $H$ is finite-dimensional then $P_{2,\mu}$ is compact and there exists a solution \Cref{rem:weak_compact}.
\end{proof}
As a consequence of \Cref{thm:nash_unique}, we can introduce an equilibrium between the Nash equilibria of a mean-field game and a game with monomorphic populations. If a mean-field game has a family of functions $U_i^{mon}$ satisfying $\nabla_{\sigma_i} U_i\mid{\sigma_i = \overbar{\sigma}_i} = \nabla_{\sigma_i} U_i^{mon}$, then the monomorphic game defined $U_i^{mon}$ has the same Nash equilbria, and can be studied equivalently.
\begin{definition}
  \label{def:correspondence}
  Consider a mean-field game with populations $N_1,\dots,N_M$ with individual payoffs $U_i(\sigma_i, (N_j \overbar{\sigma}_j)_{j=1}^M, R)$. Assume $\nabla_{\sigma_i}U_i\mid_{\sigma_i=\overbar{\sigma}_i}$ admits a primitive $U_i^{mon}$ such that $\nabla_{\sigma_i} U_i\mid{\sigma_i = \overbar{\sigma}_i} = \nabla_{\sigma_i} U_i^{mon}$.
   We define the monomorphic equivalent game as the game with monomorphic populations specified by the payoff functions $U_i^{mon}$.
\end{definition}
If a monomorphic equivalent game exists, it becomes possible to study the monomorphic game instead and e.g. use strict pseudoconvexity to establish strict pseudomonotonicity.

With \Cref{thm:nash_unique}, we can show that there exist unique fixed points of population games with strictly pseudoconvex monomorphic equivalent payoff functions and bounded dynamics.
\begin{theorem}
  \label{thm:pop_game_exists_unique}
  We have a population game with $M$ populations of size $N_i$, payoff functions $U_i(\sigma_i, (N_j \overbar{\sigma}_j)_{j=1}^M, R)$ and dynamics given by $f_i(N_j \overbar{\sigma}_j)_{j=1}^M, R),r((N_j \overbar{\sigma}_j)_{j=1}^M, R)$:
  \begin{equation}
    \dot{R} = r
    \dot{N_i} = N_i f_i
  \end{equation}
  Assume that the functions $f_i$ are strictly pseudomonotone, and that the set of stationary points of the dynamics is uniformly bounded in $(\sigma_i)_{i=1}^M$. Let the derivatives of the payoff functions $U_i$ evaluated in $\sigma_i = \overbar{\sigma}_i$ be strictly pseudomonotone, and satisfy \Cref{thm:existence}. Then the population game has a unique fixed point with a unique Nash equilibrium
\end{theorem}
\begin{proof}
  The game specified by the family $(U_i)_{i=1}^M$ has a unique Nash equilibrium for each $x\in \R^M$, given by a variational inequality problem over $P_{2,\mu}^M$ with operator $dU = (\nabla_{\sigma_i} U_i \mid_{\sigma_i = \overbar{\sigma}_i})_{i=1}^M$. The solution operator is a continuous mapping $G: P_{2,\mu}^M \to \R^M$, \cite[Theorem 4.2]{barbagallo2009continuity}. Likewise, due to the assumptions on $f_i$ the variational inequality on $\R^M$ defined by $(f_i)_{i=1}^M$ has a unique solution for every $\sigma$. Denote this solution function by $F$, which is once again continuous.

  Finding a fixed point of the dynamical system along with a Nash equilibrium then corresponds to finding a fixed point of $F\circ H: \R_+^M \to \R_+^M$. Since the set of stationary points is assumed bounded, $F$ has compact range, and $F\circ G$ has compact range. Therefore $F\circ G:\R^M \to \R^M$ has a fixed point by Schauders fixed point theorem.
  For uniqueness, note that for each vector $\sigma$, the variational inequality
  \begin{equation}
    x \in \R_+^M, \ip{(f_i_{i=1}^M(x)}{y-x}\geq 0 \quad y\in \R_+^M
  \end{equation}
  has a unique solution, by strict pseudomonotonicity of $f_i$. If we append the two operators $(f_i)_{i=1}^M$ and $dU$, we get a single strictly pseudomonotone variational inequality, where the solution is unique if it exists.
   Therefore the simultaneous problem
  \begin{equation}
    \begin{split}
    S\in P_{2,\mu}^M, \ip{dU(S))}{S'-S} \geq 0, \quad S' \in P_{2,\mu}^M \\
    x \in \R_+^M, \ip{(f_i)_{i=1}^M(x)}{y-x}\geq 0 \quad y\in \R_+^M
  \end{split}
  \end{equation}
    has a unique solution, showing the existence and uniqueness of a fixed point for a population game.
\end{proof}
Remark that the assumption of uniformly bounded fixed-point space as a function of the strategies is biologically reasonable, since e.g. Type II growth functions are uniformly bounded and a metabolic loss is usually constant.

Having established the general theory for Nash equilibria, and demonstrated how to handle mean-field games as monomorphic games, we are ready to apply the theory to a Rosenzweig-MacArthur system with fast adaptive behavior.
\section{Revisiting the Rosenzweig-MacArthur model}
\label{sec:model_rm}
%Having established the general framework, we can proceed to defining the concrete model of interest.
We consider a predator-prey system modeled as a Rosenzweig-MacArthur system, where the predators are specialized so that their hunting success is maximal in the most productive zone of the habitat.
We assume that predators $(N_p)$ and consumers $(N_c)$ inhabit the interval $[0,1]$, and $P_{2,\mu}$ are square-integrable probability densities which are absolutely continuous with respect to the Lebesgue measure. The mean strategy of the predator and consumer populations is, respectively $\overbar{\sigma}_c$, and $\overbar{\sigma}_p$.
The population dynamics are a modified Rosenzweig-MacArthur system. The predator clearance rate is $\beta_p = \beta_{l} + \beta_0$ where $\beta_l$ varies locally and $\beta_0$ is the minimal clearance rate.
Consumption events are assumed local, so the expected encounter rate between predators and prey is $N_c N_p \ip{\beta_p \overbar{\sigma}_p}{\overbar{\sigma}_c}$. To model intraspecific predator competition, we have added a term $N_p c\ip{\beta \overbar{\sigma}_p}{\overbar{\sigma}_p}$ where $c$ is a competition parameter. The carrying capacity is $K\phi + K_0$, where $\phi$ is a distribution, and $K_0$ is the minimal carrying capacity. Denote the maximal predator consumption rate by $F_p$, then the dynamics are:
\begin{align}
  \dot{N_c} &= f_c = N_c \pa{\ip{\overbar{\sigma}_c}{1-N_c \frac{\sigma_c \overbar{\sigma}_c}{K\phi + K_0}} - \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_p}{F_p + \ip{\beta_p \overbar{\sigma}_p}{\overbar{\sigma}_c} N_c} } \\
  \dot{N_p} &= f_p = N_p \pa{\epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c} - c \ip{\overbar{\sigma}_p}{\beta_p \overbar{\sigma}_p}  - \mu_p}
  \label{eq:dynamics}
\end{align}
the functions $\beta_p$ and $\phi$ are defined as
\begin{align}
  \beta_p &= 5 \frac{\exp(-(3 x)^2) + \beta_0}{\int_0^1 \exp(-(3 x)^2) + \beta_0 dx} \\
  \phi &= \frac{\exp(-3 x) + K_0}{\int_0^1 \exp(-3 x) dx + K_0 }
\end{align}
The choice of functions reflect a heterogeneous productivity and a predator specialized in hunting in the most productive zones.
\subsection{Existence and uniqueness of the equilibrium}
As in \Cref{sec:general_setting} we model predator and consumer movement as instantaneous. Each predator and consumer seeks to maximize its growth at every instant. The growth of an individual depends on the mean-field strategies of both predators and consumers. Denoting the individual consumer and predator strategies by $\sigma_c$ and $\sigma_p$ respectively, the instantaneous growths $U_c,U_p$ for a consumer and predator are:
\begin{align}
  U_c(\sigma_c, N_c \overbar{\sigma}_c, N_p\overbar{\sigma}_p) &= \ip{\beta_c \sigma_c}{1-\frac{\sigma_c \overbar{\sigma}_c N_c}{K\phi + K_0}} - \frac{F_p \ip{\beta_p \sigma_c}{\overbar{\sigma}_p} N_p}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\overbar{\sigma}_p} N_c} \\
  U_p(\sigma_p, N_p \overbar{\sigma}_c, \overbar{\sigma}_p) &= \epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}{F_p + \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c} - c \ip{\sigma_p}{\beta_p \overbar{\sigma}_p}  - \mu_p
\end{align}
Denote the optimum by $^*$. At the Nash equilibrium $\sigma_c^*=\overbar{\sigma}_c$ and $\sigma_p^* = \overbar{\sigma}_p$. We convert both mean-field payoffs into a monomorphic equivalent form \Cref{def:correspondence}
\begin{align}
  \label{eq:mon_eq_forms}
  U_c^{mon}(\sigma_c, \sigma_p, N_c, N_p) &= \ip{\beta_c \sigma_c}{1-\frac{3}{2}\frac{\sigma_c^2 N_c}{K\phi + K_0}} - N_p\log\pa{F_p + \ip{\beta_p \sigma_c}{\sigma_p} N_c} \\
  U_p^{mon}(\sigma_p, \sigma_c, N_c, N_p) &= \epsilon \frac{F_p \ip{\beta_p \overbar{\sigma}_c}{\sigma_p} N_c}{F_p + \ip{\beta_p \sigma_c}{\sigma_p} N_c} - \frac{1}{2}c \ip{\sigma_p}{\beta_p \sigma_p}N_p  - \mu_p
\end{align}
We need to verify that $-U_c^{mon}$ and $-U_p^{mon}$ are strictly pseudoconvex, as well as show existence. To this end, we state a characterization of strict pseudomonotonicity for differentiable functions.
\begin{lemma}
  \label{lem:strict_pm}
  Let $K$ be a convex subset of $H$. A function $f: K \to \R$ is strictly pseudomonotone if
  \begin{equation}
    \ip{f(x)}{u} = 0 \Rightarrow \ip{(\nabla_x f(x))h}{h} > 0
  \end{equation}
\end{lemma}
A proof can be found in \citep[Proposition 2.8, p.96]{hadjisavvas2006handbook}.
Another small lemma we need is a reduction for pseudomonotone functions.
\begin{lemma}
  \label{lem:pseudo_reduc}
  A function $g: P_{2,\mu} \to H$ is pseudomonotone if and only if $g+\lambda$ is pseudomonotone for any $\lambda \in \R$.
\end{lemma}
\begin{proof}
  Consider $\ip{g(x)+\lambda}{x-y}=\ip{g(x)}{x-y}+\lambda \int x d\mu + \lambda \int y d\mu$
  Using that $\int y d\mu = \int x d\mu = 1$, we arrive at  $\ip{g(x)}{x-y}$.
  Hence the pseudomonotonicity of $g$ and $g+\lambda$ are equivalent.
\end{proof}
This allows us to state our main result on the behaviorally modified Rosenzweig-MacArthur game.
\begin{proposition}
  \label{prop:exist_unique_nash}
  The game defined by $U_c$ and $U_p$ has a unique Nash equilibrium for every non-zero pair $N_c,N_p$.
\end{proposition}
\begin{proof}
  It suffices to show that the functions $-U_c^{mon}$ and $-U_p^{mon}$ are strictly pseudoconvex for uniqueness. For existence it remains to show that the varviational inequality defined by the function
  \begin{equation}
    \label{eq:var_ineq}
    dU = \begin{pmatrix}-\nabla_{\sigma_c} U_c^{mon} \\ -\nabla_{\sigma_p} U_p^{mon}\end{pmatrix}
  \end{equation} satisfy the criteria of \Cref{thm:existence}.
  We start by showing the strict pseudoconvexity. The function $-U_p^{mon}$ is strictly convex, as it has strictly positive second derivative with respect $\sigma_p$. Consider $-U_c^{mon}$. To show strict pseudoconvexity, by \Cref{lem:pseudo_reduc} it suffices to show that $f = -\nabla_{\sigma_c} U_c^{mon} - 1$ is strictly pseudomonotone. For \Cref{lem:strict_pm} assume $\ip{f(x)}{u} = 0$, then
  \begin{equation}
    \ip{x}{u}\frac{N_c \beta_c }{K\phi + K_0} + \frac{\ip{\sigma_p}{h}}{F_p + \ip{\sigma_p}{x}} = 0
  \end{equation}
  Since every term is positive, $\ip{x}{u} = 0$ and $\ip{\sigma_p}{h} = 0$. If we consider
  \begin{equation}
    H(x,u)=\ip{(\nabla_x f)(x)u}{u} = \ip{u}{u}\frac{ C \beta_c }{K\phi + K_0} - \frac{\ip{\sigma_p}{u}\ip{\sigma_p}{h}}{F_p + \ip{\sigma_p}{x}}
  \end{equation}
  then $H(x,u)>0$ since $\ip{\sigma_p}{u}=0$, so $H$ is strictly pseudomonotone by \Cref{lem:strict_pm}. Hence $-U_c^{mon}$ is strictly pseudoconvex.

  To show that there exists a solution, start by noting that for all $w\in H^2$, $w\mapsto dU(w)$ is continuous, hence continuous on finite-dimensional subspaces, fulfilling the first part of \Cref{thm:existence}. For the second part,  consider
  \begin{equation}
    \label{eq:du}
    \begin{split}
    \ip{-dU(\sigma_c,\sigma_p)}{(1-\sigma_c, 1-\sigma_p)} =
    \ip{dU(\sigma_c,\sigma_p)}{(\sigma_c-1, \sigma_p-1)}
  \end{split}
  \end{equation}
  To avoid clutter, we neglect the calculations and relegate them to the appendix \Cref{appendix:calculations}. In the end, the inner product reduces to
  \begin{equation}
    \label{eq:fin_exist}
    \norm{\sigma_c}_2^2 + \norm{\sigma_p}_2^2 - \norm{\sigma_c}_1 - \norm{\sigma_p}_1 - G_1(\sigma_c,\sigma_p) - G_2(\sigma_c,\sigma_p)
  \end{equation}
  where $G_1,G_2$ are uniformly bounded. Recall that constraining the problem to $P_{2,\mu}$ is equivalent to $\norm{\sigma_c}_1 = 1, \norm{\sigma_p} = 1$. Hence \Cref{eq:fin_exist} tends to infinity as $\norm{(\sigma_c,\sigma_p)}_2$ tends to infinity. Therefore \Cref{eq:du} is only negative on a bounded subset of $P_{2,\mu}$. By by \Cref{thm:existence} this shows existence of a solution to the variational inequality defined by the function \Cref{eq:var_ineq}.

\end{proof}
Since we are interested in the fixed-points of the population dynamics \Cref{eq:dynamics}, we would like to show that a fixed-point of the dynamics exists and is unique.
\begin{corollary}
  The population game \Cref{eq:dynamics} has a unique fixed point.
\end{corollary}
\begin{proof}
Here we can directly use the theory we have developed.  Both $f_1/N_c$ and $f_2/N_p$ are strictly monotone, hence strictly pseudomonotone. Due to the metabolic terms and logistic terms set of fixed-points of these are uniformly bounded in $\sigma_c, \sigma_p$. By \Cref{prop:exist_unique_nash} the Nash equilibrium exists and is unique for every $N_c, N_p$. Therefore, by \Cref{thm:pop_game_exists_unique} there is a unique equilibrium for the population game.
\end{proof}
