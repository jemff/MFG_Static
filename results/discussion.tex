\section{Discussion and conclusion}


We redefine the notion of a population game, based on choices optimizing individual growth, modifying the definition of \citep{vincent2005evolutionary}. This is done through the introduction of mean-field games. We establish the necessity of the mean-field approach, showing that it generalizes the classical ideal free distribution. In addition, we show that the individual optimization is much less efficient when assuming a population playing a mean-field game compared to a monomorphic population. We demonstrate a procedure to reformulate a large class of mean-field games into normal-form games, allowing analysis as classical games. Having reduced our problem to that of finding Nash equilibria for classical games, we establish existence and uniqueness of Nash equilibria for a large class of games using variational inequalities. A major advance is that we are inherently able to handle continuous strategy spaces. Having determined existence and uniqueness of Nash equilibrium the instantaneous game, we turn to the existence and uniqueness of fixed-points for population games. We show that a large class of population games as we define them have a unique equilibrium.
Using the framework CasADi, we are able to efficiently solve these population games numerically, and analyze the sensitivity of population levels and strategy distributions. We illustrate this with a behavorially modified Rosenzweig-MacArthur system.

We show the framework of mean-field games is applicable in ecology through multi-species population games with optimal individual behavior. We establish theoretical results for existence and uniqueness of Nash equilibria with continuous strategy spaces.

The payoff for an individual in a large population of indistinguishable individuals is shown much higher when all individuals are a-priori assumed to follow the same strategy.

Though a population of animals may all be indistinguishable, and appear to follow the same strategy, it is important to consider how this monomorphism emerges. The per capita utility from each individual optimizing is much higher for a population which is assumed monomorphic in comparison to one where the monomorphism emerges as a mean-field nash equilibriums.

We showed that the Nash equilibrium exists is and is unique for a large class of games, even with continuous strategy spaces, and the results can be applied to mean-field games through the notion of equivalent monomorphic games. Our results on the existence and the uniqueness of the Nash equilibrium allowed us to show that there exists a unique equilibrium for a wide class of biologically relevant population games. The approach based on fixed-point theory used to show the existence and uniquenss of this simultanous problem appears generalizble to a wider class of population games, allowing for populations where the problem of finding a fixed point cannot be interpreted as a variational inequality.

%We show that a behavorially modified Rosenzweig-MacArthur model has a unique equilibrium by drawing on the general theory we developed. This opens up for sensitivity analysis of the Rosenzweig-MacArthur with respect to the carrying capacity, and the intraspecific predator competition. This analysis is facilitated by a numerical approach based on complementarity. Posing the problem as a complementarity problem changes an optimization problem into a feasibility problem, which is handily solved by IPOPT using the HSL subroutines. The runtimes were impressive, even with a discretization with several hundred grid points.

We found that increasing carrying capacity causes an all-round population increase, and more dispersed populations, in agreement with empirical evidence. When increasing intrapredator competition, we found that predators were more disperesed at the population fixed-point. In accordance with the ideal free distribution, the population of consumers was also increasingly dispersed due to intraspecific competition from the increasing population caused by lower predation loss. Adding behavior to a relatively simple model drastically expands the scope of phenonenoma that can be modeled, and allows us to make complex predictions from simple models that correspond to empirical findings on population distributions in ecosystems.


By bringing the results from variational inequalities into mathematical ecology, we introduce relatively simple criteria for when a game has a unique Nash equilibrium, allowing for a much less ad-hoc approach to population games and instead providing general tools for the working mathematical biologist. In this way, incorporating behavior in a wide array of models becomes feasible for non-experts, and in particular behavior can be easily incorporated in population models. Our results highlight the need to take care of whether considering individual or group-level optimization, and directly illustrate the strength of group-level optimization. This shows the benefit of hive-mentalities, where individuals might optimize for themselves, but with the knowledge of what the rest of the population is doing.

Our numerical approach for finding Nash equilbria is simple, and can readily be applied in general models. Since our approach is inherently built for continuous habitats, we allow the simulation of realistic ecosystems, and models incorporating behavior in this fashion could e.g. include diffusion terms for resources in continuous ecosystems. The general applicability also allows for modeling complex habitats in hihgher dimensions.

We provide a large step forward from previous approaches based on linear models, where specialized software for solving the linear complementarity was used \citep{patrizio}. By using a general-purpose optimization package, we are unable to leverage the structure inherent in the variational inequality. If the approach is used in large-scale ecosystem modeling for concrete applications, it is probably advantageous to solve the complementarity problem with dedicated software such as PATH or Siconos.

We have not touched on the topic of differential games, instead focusing on myopic optimization. By using Pontryagins princiople, the approach we introduce can also be applied setting by considering the players' Hamiltonians through differential variational inequalities \citep{pangstewart2008}.


%KKT can be reformulated as VI, developed by stampacchia mangasarian goeleven et al
%VI solvable numerically, NE existence gives that minimum exists and is 0
%Wide class of VI unique solution, applicable?
%Write up equations for two players, remark that the same for N

%\begin{enumerate}
%  \item What did we find?
%    Highlighted difference between individual and group-level Optimization
%    Concrete calculations showing that individual optimization is less efficient than group level
%    Showed existence and uniqueness of Nash equilibrium
%    Showed existence and uniqueness of population game equilibrium
%    Demonstrted on behavorially modified Rosenzweig-MacArthur model
%    Fast and efficient numerical approach
%  \item What do our results mean?
%    we now have good criteria for uniqueness and existence, less ad-hoc.%
    %Behavior can become the norm.
    %Models need to look at the individual perspective rather than population level.
    %Illustrates the difference between emergent monomorphism and inherent monomorphism
    %Selfish behavior is much less advantageous for the collective

%  \item Perspectives in VI for NE in ecology  Compare to literature also the stuff by Patrizio. remark well-known that worse for species than population-thingy
%    Fast numerics can be implemented by anynone, for a fairly general set of games not just related to populations
%    Feasible to implemement population games generally, behavior can be as much of a choice as seasons
%    Realistic models of ecosystems
%    The work is hinted at in the work of Sandholm, but not developed further.
%    We focus on continuous, but much stronger results actually hold in finite habitat choice setting.
%    It has become possible to include bona-fide continuous habitats.
%  \item
%    Games with long-term optimization can be implemented as differential variational inequalities
%    Multiple species in actual Applications
%    Check the Scalability
%    Try wtih dedicated software, see how fast it can get.
%
%\end{enumerate}
