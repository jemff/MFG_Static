\section{Discussion and conclusion}

We study study population games, based on optimizing individual growth, modifying the definition of \citep{vincent2005evolutionary}. This is done through the introduction of mean-field games, which we show generalizes the ideal free distribution \citep{fretwell1969territorial}. We demonstrate that assuming a monomorphic population is not a viable alternative to the mean-field approach. We do this by showing that the pr. capita payoff a monomorphic population is twice what could be expected from playing the field  \citep{parker1978searching} . Hence, though a population of animals may all be indistinguishable, and appear to follow the same strategy, it is important to consider how this monomorphism emerges. The per capita utility from each individual optimizing is much higher for a population which is assumed monomorphic in comparison to one where the monomorphism emerges as a mean-field Nash equilibrium.


We demonstrate a procedure to reformulate a large class of mean-field games into normal-form games, allowing analysis as classical games. Having reduced our problem to that of finding Nash equilibria for classical games, we establish existence and uniqueness of Nash equilibria for a large class of games using variational inequalities. In particular, we are able to handle continuous strategy spaces. Having determined existence and uniqueness of Nash equilibrium for the instantaneous game, we show the corresponding results for fixed-points for population games. By going this general route, we provide a more efficient way of showing existence and uniqueness and uniqueness than the usual tailor-made methodes \citep{cressman2010ideal,kvrivan2009evolutionary}. The general nature of the payoff functions that can be handled by our method provides a large step forward from previous approaches, which only allowed bilinear payoffs \citep{mariani2016migration, pinti2021co}. We can simulate population dynamics with behavior in realistic ecosystems, since we inherently handle a mixture of discrete and continuous habitats. Using a general-purpose optimization package, we are unable to leverage the structure inherent in the variational inequality. If the method we advance is used in large-scale ecosystem modeling for concrete applications, it is probably advantageous to solve the complementarity problem with dedicated software such as PATH or Siconos \citep{dirkse1995path, acary2019introduction}.



Analyzing a Rosenzweig-MacArthur model with behavior, revealed a powerful stabilization of the population dynamics. This stabilization agrees with results on population games in models with finite strategy spaces \citep{kvrivan2007lotka, valdovinos2010consequences}. We have been unable to show analytically why this stability emerges, but a fruitful avenue of attack could be drawing on the theory of complementarity-constrained dynamical systems \citep{adly2018variational,brogliato2020dynamical}.  In the sensitivity analysis, we found that increasing carrying capacity causes an all-round population increase, and more dispersed populations, which can be tested empirically. When increasing intrapredator competition, we found that sufficiently competitive predators were concentrated in the most unproductive zones. In accordance with the ideal free distribution, the population of consumers was dispersed due to intraspecific competition from the increasing population caused by lower predation loss.


Adding behavior to a relatively simple model drastically expands the scope of phenomena that can be modeled, and allows us to make complex predictions from simple models that correspond to empirical findings on population distributions in ecosystems.


The results on the existence and the uniqueness of the Nash equilibrium allowed us to show that there exists a unique equilibrium for a wide class of biologically relevant population games. The approach based on fixed-point theory used to show the existence and uniqueness of this simultaneous problem appears to generalize to a wider class of population games, allowing for populations where the problem of finding a fixed point cannot be interpreted as a variational inequality. By bringing the results from variational inequalities into mathematical ecology, we introduce criteria to establish when a game has a unique Nash equilibrium. This gives us a general approach to population games, where previously only a few specific types could be handled. \citep{sandholm2010population}. Our focus has been on population games, but our results on existence and uniqueness are generally applicable to games in ecology.


We have not touched on the topic of differential games, instead focusing on myopic optimization. By using Pontryagins principle, the approach we introduce can also be applied setting by considering the players' Hamiltonians through differential variational inequalities \citep{pang2008differential}.

  %We show the framework of mean-field games is applicable in ecology through multi-species population games with optimal individual behavior. We establish theoretical results for existence and uniqueness of Nash equilibria with continuous strategy spaces.

%The payoff for an individual in a large population of indistinguishable individuals is shown much higher when all individuals are a-priori assumed to follow the same strategy.



%We show that a behavorially modified Rosenzweig-MacArthur model has a unique equilibrium by drawing on the general theory we developed. This opens up for sensitivity analysis of the Rosenzweig-MacArthur with respect to the carrying capacity, and the intraspecific predator competition. This analysis is facilitated by a numerical approach based on complementarity. Posing the problem as a complementarity problem changes an optimization problem into a feasibility problem, which is handily solved by IPOPT using the HSL subroutines. The runtimes were impressive, even with a discretization with several hundred grid points.





%KKT can be reformulated as VI, developed by stampacchia mangasarian goeleven et al
%VI solvable numerically, NE existence gives that minimum exists and is 0
%Wide class of VI unique solution, applicable?
%Write up equations for two players, remark that the same for N

%\begin{enumerate}
%  \item What did we find?
%    Highlighted difference between individual and group-level Optimization
%    Concrete calculations showing that individual optimization is less efficient than group level
%    Showed existence and uniqueness of Nash equilibrium
%    Showed existence and uniqueness of population game equilibrium
%    Demonstrted on behavorially modified Rosenzweig-MacArthur model
%    Fast and efficient numerical approach
%  \item What do our results mean?
%    we now have good criteria for uniqueness and existence, less ad-hoc.%
    %Behavior can become the norm.
    %Models need to look at the individual perspective rather than population level.
    %Illustrates the difference between emergent monomorphism and inherent monomorphism
    %Selfish behavior is much less advantageous for the collective

%  \item Perspectives in VI for NE in ecology  Compare to literature also the stuff by Patrizio. remark well-known that worse for species than population-thingy
%    Fast numerics can be implemented by anynone, for a fairly general set of games not just related to populations
%    Feasible to implemement population games generally, behavior can be as much of a choice as seasons
%    Realistic models of ecosystems
%    The work is hinted at in the work of Sandholm, but not developed further.
%    We focus on continuous, but much stronger results actually hold in finite habitat choice setting.
%    It has become possible to include bona-fide continuous habitats.
%  \item
%    Games with long-term optimization can be implemented as differential variational inequalities
%    Multiple species in actual Applications
%    Check the Scalability
%    Try wtih dedicated software, see how fast it can get.
%
%\end{enumerate}
