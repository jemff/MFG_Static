\section{Discussion and conclusion}


\begin{comment}
We demonstrate that assuming a monomorphic population is not a viable alternative to the mean-field approach. We do this by showing that the pr. capita payoff a monomorphic population is twice what could be expected from playing the field  \citep{parker1978searching}. Hence, though a population of animals may all be indistinguishable, and appear to follow the same behavioral strategy, it is important to consider how this monomorphism emerges.
\end{comment}

We study population games through the introduction of mean-field games, which generalize the ideal free distribution \citep{fretwell1969territorial} to multi-species settings, albeit without the dynamical considerations of the multi-species ideal-free distribution \citep{cressman2010ideal}. We establish existence and uniqueness of Nash equilibria for a large class of population games using variational inequalities. In particular, we are able to handle a wide class of payoff functions with unique extrema and continuous strategy spaces. Having determined existence and uniqueness of Nash equilibrium for the instantaneous game, we showed the existence and uniqueness of fixed-points for suitably nice population games. This provides a simple criterion for population games, extending theorems based on specific models \citep{cressman2010ideal,sandholm2010population}. As such, our work provides a multi-species generalization of the work on two-species ideal free distributions, \citep{cressman2010ideal, cressman2004ideal} and provides a generalization of the criteria for a unique equilibrium in a habitat selection game \citep[Appendix B]{cressman2006migration}.


 %Our focus has been on population games, but the results on existence and uniqueness of Nash equilibria in mean-field games are generally applicable to games in biology.

We demonstrate the utility of our results by applying them to study a Rosenzweig-MacArthur system with fast optimal behavior. We easily establish existence and uniqueness of Nash equilibria, both for only consumers or predators and when both have optimal behavior. The method of proof is computational and combinatorial in nature, and hence can almost certainly be extended to larger more complex ecosystems where the Nash equilibrium appears unique but has not been shown to be unique \cite{pinti2019trophic}.  This shows that our general results open up the study of population games from a general mathematical viewpoint than has otherwise been the case, \citep{cressman2010ideal, kvrivan2013behavioral, kvrivan2009evolutionary, broom2013game}.


After showing existence and uniqueness, we analyzed the modified Rosenzweig-MacArthur game numerically by discretizing space. Adding optimal individual behavior appears to eliminate the paradox of enrichment \citep{rosenzweig1971paradox}, which is a common consequence of optimal behavior in ecosystem models \citep{abrams2010implications}. We were unable to find a Lyapunov function to provide a theoretical justification \citep{kvrivan2009evolutionary}. In the sensitivity analysis we saw that the the intraspecific predator competition did not noticeably affect the predator population levels, while elevating the consumer population levels, which was surprising \citep{abrams2010implications}. The increase in carrying capacity increased both predator and prey levels, as is usually the case in models with optimal behavior \citep{valdovinos2010consequences}. The sensitivity analysis also showed the emergence of an interesting pattern of consumer predator co-existence, with an ideal-free distribution emerging in the areas without any predators.

%Skriv noget om sensitvities analysen?

We were unable to show stability of the dynamical system, but it seems this could be done by drawing on the rapidly developing theory of dynamical variational inequalities \citep{adly2018variational,brogliato2020dynamical, tang2020differential} or studying dynamical systems associated to bi-level variational inequalities \citep{anh2021dynamical}. This could also provide a general theory of why optimal behavior generally enhances stability \citep{valdovinos2010consequences}. We have not touched on the topic of differential games, where the optimization is not instantaneous but takes e.g. the entire life-history account. Variational inequalities can be applied to differential games, \citep{pang2008differential}, so this seems like a tantalizing next step.


By introducing mean-field games and studying them through variational inequalities, we show that it is possible to model the distribution of coexisting animal populations where all seek to optimize their foraging. This enables more accurate modeling of the spatial distribution of animals along with their populations, which moves us closer to the ultimate goal of being able to model the spatial distribution of animals exactly \citep{morris2003shadows}.

%Overall our most important finding is that playing the field can be incorporated in complex population games with instantaneous behavior, and that the resulting Nash equilibrium exists and is unique across a wide range of circumstances.
  %We show the framework of mean-field games is applicable in ecology through multi-species population games with optimal individual behavior. We establish theoretical results for existence and uniqueness of Nash equilibria with continuous strategy spaces.

%The payoff for an individual in a large population of indistinguishable individuals is shown much higher when all individuals are a-priori assumed to follow the same strategy.



%We show that a behavorially modified Rosenzweig-MacArthur model has a unique equilibrium by drawing on the general theory we developed. This opens up for sensitivity analysis of the Rosenzweig-MacArthur with respect to the carrying capacity, and the intraspecific predator competition. This analysis is facilitated by a numerical approach based on complementarity. Posing the problem as a complementarity problem changes an optimization problem into a feasibility problem, which is handily solved by IPOPT using the HSL subroutines. The runtimes were impressive, even with a discretization with several hundred grid points.





%KKT can be reformulated as VI, developed by stampacchia mangasarian goeleven et al
%VI solvable numerically, NE existence gives that minimum exists and is 0
%Wide class of VI unique solution, applicable?
%Write up equations for two players, remark that the same for N

%\begin{enumerate}
%  \item What did we find?
%    Highlighted difference between individual and group-level Optimization
%    Concrete calculations showing that individual optimization is less efficient than group level
%    Showed existence and uniqueness of Nash equilibrium
%    Showed existence and uniqueness of population game equilibrium
%    Demonstrted on behavorially modified Rosenzweig-MacArthur model
%    Fast and efficient numerical approach
%  \item What do our results mean?
%    we now have good criteria for uniqueness and existence, less ad-hoc.%
    %Behavior can become the norm.
    %Models need to look at the individual perspective rather than population level.
    %Illustrates the difference between emergent monomorphism and inherent monomorphism
    %Selfish behavior is much less advantageous for the collective

%  \item Perspectives in VI for NE in ecology  Compare to literature also the stuff by Patrizio. remark well-known that worse for species than population-thingy
%    Fast numerics can be implemented by anynone, for a fairly general set of games not just related to populations
%    Feasible to implemement population games generally, behavior can be as much of a choice as seasons
%    Realistic models of ecosystems
%    The work is hinted at in the work of Sandholm, but not developed further.
%    We focus on continuous, but much stronger results actually hold in finite habitat choice setting.
%    It has become possible to include bona-fide continuous habitats.
%  \item
%    Games with long-term optimization can be implemented as differential variational inequalities
%    Multiple species in actual Applications
%    Check the Scalability
%    Try wtih dedicated software, see how fast it can get.
%
%\end{enumerate}
